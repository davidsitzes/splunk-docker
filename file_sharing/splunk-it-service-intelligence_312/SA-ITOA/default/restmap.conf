### ITOA Interface ###

#
# CRUD APIs and related APIs (like refresh) for ITOA interface
#
[script:itoa_interface_service_capability]
# Path like /itoa_interface/<object type needing service capability>/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(entity|service|kpi|kpi_template|entity_relationship|entity_relationship_rule|team)/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
capability.get=read_itsi_service
capability.post=write_itsi_service
capability.put=write_itsi_service
capability.delete=delete_itsi_service
passHttpHeaders=true
passPayload=true

[script:itoa_interface_kpi_base_search_capability]
# Path like /itoa_interface/vLatest/<object type needing KPI base search capability>/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(kpi_base_search)/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
capability.get=read_itsi_kpi_base_search
capability.post=write_itsi_kpi_base_search
capability.put=write_itsi_kpi_base_search
capability.delete=delete_itsi_kpi_base_search
passHttpHeaders=true
passPayload=true

[script:itoa_interface_kpi_threshold_template_capability]
# Path like /itoa_interface/vLatest/<object type needing KPI threshold template capability>/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(kpi_threshold_template)/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
capability.get=read_itsi_kpi_threshold_template
capability.post=write_itsi_kpi_threshold_template
capability.put=write_itsi_kpi_threshold_template
capability.delete=delete_itsi_kpi_threshold_template
passHttpHeaders=true
passPayload=true

[script:itoa_interface_base_service_template_capability]
# Path like /itoa_interface/vLatest/<object type needing base service template capability>/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(base_service_template)/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
capability.get=read_itsi_base_service_template
capability.post=write_itsi_base_service_template
capability.put=write_itsi_base_service_template
capability.delete=delete_itsi_base_service_template
passHttpHeaders=true
passPayload=true

[script:itoa_interface_temporary_kpi_capability]
# Path like /itoa_interface/<object type needing Temporary KPI capability>/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/temporary_kpi/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
capability.get=read_itsi_temporary_kpi
capability.post=write_itsi_temporary_kpi
capability.put=write_itsi_temporary_kpi
capability.delete=delete_itsi_temporary_kpi
passHttpHeaders=true
passPayload=true

[script:itoa_interface_private_capability]
# Path like /itoa_interface/<object type needing private capability checked in handler>/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(deep_dive|glass_table|home_view)/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
passHttpHeaders=true
passPayload=true

[script:itoa_interface_event_management_state_capability]
# Path like /itoa_interface/<object type needing event management state capability>/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/event_management_state/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
capability.get=read_itsi_event_management_state
capability.post=write_itsi_event_management_state
capability.put=write_itsi_event_management_state
capability.delete=delete_itsi_event_management_state
passPayload=true

[script:itoa_interface_no_capability_checks]
# Path like /itoa_interface/<object type needing no capability check>/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/saved_page/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
passHttpHeaders=true
passPayload=true

#
# Permissions API for Interactable object types in ITOA interface
#

[script:itoa_interface_rbac_capability]
# Path like /itoa_interface/<object type needing rbac capability>/[<id>/]perms/
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(home_view|glass_table|deep_dive)/.*/*perms/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
capability=configure_perms
passPayload=true

#
# Helper APIs for ITOA interface needing capability checks
#

[script:itoa_interface_helper_service_capability]
# Path like /itoa_interface/load_csv/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(load_csv|generate_entity_filter|get_kpi_searches|get_search_clause|preview_merge|get_alias_list|get_backfill_search|get_entity_filter|get_service_trees)/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
capability.get=read_itsi_service
capability.post=write_itsi_service
capability.put=write_itsi_service
capability.delete=delete_itsi_service
passPayload=true


[script:itoa_interface_helper_gt_capability]
# Path like /itoa_interface/load_csv/...
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(get_kpi_searches_gt)/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
capability.get=read_itsi_glass_table
capability.post=write_itsi_glass_table
capability.put=write_itsi_glass_table
capability.delete=delete_itsi_glass_table
passPayload=true

#
# Other ITOA interface APIs
#

[script:itoa_interface_generic_no_capability_checks]
# Path like /itoa_interface/get_supported_object_types/
match=/itoa_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/get_supported_object_types/?
handler=itoa_rest_interface_splunkd.ItoaRestInterfaceSplunkd
scripttype=persist
script=itoa_rest_interface_splunkd.py
output_modes=json
passPayload=true

### Maintenance Services Interface ###

#
# CRUD APIs and related APIs (like count) for maintenance services interface
#

[script:maintenance_services_interface_maintenance_calendar_capability]
# Path like /maintenance_services_interface/<object type needing maintenance calendar capability>/...
match=/maintenance_services_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/maintenance_calendar/?
handler=maintenance_services_interface_splunkd.MaintenanceServicesInterfaceSplunkd
scripttype=persist
script=maintenance_services_interface_splunkd.py
output_modes=json
capability.get=read-maintenance_calendar
capability.post=write-maintenance_calendar
capability.put=write-maintenance_calendar
capability.delete=delete-maintenance_calendar
passPayload=true

#
# Other maintenance services interface APIs
#
[script:maintenance_services_interface_generic_no_capability_checks]
# Path like /maintenance_services_interface/get_supported_object_types/
match=/maintenance_services_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/get_supported_object_types/?
handler=maintenance_services_interface_splunkd.MaintenanceServicesInterfaceSplunkd
scripttype=persist
script=maintenance_services_interface_splunkd.py
output_modes=json
passPayload=true

### Backup/Restore Interface ###

#
# CRUD APIs and related APIs (like count) for backup restore interface
#

[script:backup_restore_interface_backup_restore_capability]
# Path like /backup_restore_interface/<object type needing backup restore capability>/...
match=/backup_restore_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(backup_restore)/?
handler=backup_restore_interface_splunkd.BackupRestoreInterfaceSplunkd
scripttype=persist
script=backup_restore_interface_splunkd.py
output_modes=json
capability.get=read_itsi_backup_restore
capability.post=write_itsi_backup_restore
capability.put=write_itsi_backup_restore
capability.delete=delete_itsi_backup_restore
passPayload=true

### Event Management Interface ###

#
# CRUD APIs and related APIs (like count) for event management interface
#

[script:event_management_interface_notable_event_capability]
# Path like /event_management_interface/<object type needing notable event capability>/...
match=/event_management_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(notable_event|notable_event_tag|notable_event_comment)/?
handler=event_management_interface_splunkd.EventManagementInterfaceSplunkd
scripttype=persist
script=event_management_interface_splunkd.py
output_modes=json
capability.get=read-notable_event
capability.post=write-notable_event
capability.put=write-notable_event
capability.delete=delete-notable_event
passPayload=true

[script:event_management_interface_notable_event_aggregation_policy_capability]
# Path like /event_management_interface/<object type needing notable event aggregation policy capability>/...
match=/event_management_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/notable_event_aggregation_policy/?
handler=event_management_interface_splunkd.EventManagementInterfaceSplunkd
scripttype=persist
script=event_management_interface_splunkd.py
output_modes=json
capability.get=read_itsi_notable_aggregation_policy
capability.post=write_itsi_notable_aggregation_policy
capability.put=write_itsi_notable_aggregation_policy
capability.delete=delete_itsi_notable_aggregation_policy
passPayload=true


#
# Permissions API for notable events aggregation policy in event management interface
#

[script:_notable_event_aggregation_policy_rbac_capability]
# Path like /event_management_interface/<notable event aggregation policy needing rbac capability/[<id>/]perms/
match=/event_management_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/notable_event_aggregation_policy/.*/*perms/?
handler=event_management_interface_splunkd.EventManagementInterfaceSplunkd
scripttype=persist
script=event_management_interface_splunkd.py
output_modes=json
capability=configure_perms
passPayload=true

[script:event_management_interface_correlation_search_capability]
# Path like /event_management_interface/<object type needing correlation search capability>/...
match=/event_management_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/correlation_search/?
handler=event_management_interface_splunkd.EventManagementInterfaceSplunkd
scripttype=persist
script=event_management_interface_splunkd.py
output_modes=json
capability.get=read_itsi_correlation_search
capability.post=write_itsi_correlation_search
capability.put=write_itsi_correlation_search
capability.delete=delete_itsi_correlation_search
passPayload=true

#
# Permissions API for correlation search in event management interface
#

[script:_correlation_search_rbac_capability]
# Path like /event_management_interface/<correlation search needing rbac capability/[<id>/]perms/
match=/event_management_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/correlation_search/.*/*perms/?
handler=event_management_interface_splunkd.EventManagementInterfaceSplunkd
scripttype=persist
script=event_management_interface_splunkd.py
output_modes=json
capability=configure_perms
passPayload=true

#
# Other event management interface methods
#

[script:event_management_interface_notable_event_action_capability]
# Path like /event_management_interface/<object type needing notable event action capability>/...
match=/event_management_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(notable_event_group|notable_event_actions|notable_event_group_action)/?
handler=event_management_interface_splunkd.EventManagementInterfaceSplunkd
scripttype=persist
script=event_management_interface_splunkd.py
output_modes=json
capability.get=read-notable_event_action
capability.post=execute-notable_event_action
capability.put=execute-notable_event_action
capability.delete=execute-notable_event_action
passPayload=true

[script:event_management_interface_methods_notable_event_capability]
# Path like /event_management_interface/ticketing/...
match=/event_management_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/ticketing/?
handler=event_management_interface_splunkd.EventManagementInterfaceSplunkd
scripttype=persist
script=event_management_interface_splunkd.py
output_modes=json
capability.get=read-notable_event_action
capability.post=write-notable_event
capability.put=write-notable_event
capability.delete=delete-notable_event
passPayload=true

[script:event_management_interface_no_capability_checks]
# Path like /event_management_interface/notable_event_configuration/...
match=/event_management_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/notable_event_configuration/?
handler=event_management_interface_splunkd.EventManagementInterfaceSplunkd
scripttype=persist
script=event_management_interface_splunkd.py
output_modes=json
passPayload=true

[script:notable_event_ace_interface_splunkd]
match=/ace_interface/?
handler=notable_event_ace_interface_splunkd.NotableEventAceInterfaceSplunkd
scripttype=persist
script=notable_event_ace_interface_splunkd.py
output_modes=json
passHttpHeaders=true
passPayload=true

### Other Interfaces

[script:backfill_services]
match=/backfill_services/?
handler=backfill_services.backfill_services

[script:health_services]
match=/health_services/?
handler=health_services.health_services

[validation: savedsearches]
action.itsi_event_generator.param.owner = validate( isstr('action.event_generator.param.owner'), "'action.event_generator.param.owner' must be a valid string value")
action.itsi_event_generator.param.status = validate( isint('action.event_generator.param.status'), "'action.event_generator.param.status' must be a int value")
action.itsi_event_generator.param.severity = validate( isint('action.event_generator.param.severity'), "'action.event_generator.param.severity' must be a int value")

[script:itsi_module_interface]
match=/itsi_module_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/?
handler=itsi_module_interface_splunkd.ItsiModuleInterfaceSplunkd
scripttype=persist
script=itsi_module_interface_splunkd.py
output_modes=json
passHttpHeaders=true
capability.get=read-module_interface
capability.post=write-module_interface
capability.put=write-module_interface
capability.delete=delete-module_interface
passPayload=true

################# Internal use only #########################

[script:event_management_interface_no_capability_checks_internal_use]
# Path like /event_management_interface/mad_event_action/...
match=/event_management_interface(/(vLatest|v[0-9]+(\.[0-9]+){0,2})){0,1}/(mad_event_action|user_message_mad_event)/?
handler=event_management_interface_splunkd.EventManagementInterfaceSplunkd
scripttype=persist
script=event_management_interface_splunkd.py
output_modes=json

 ## capabilities are not defined in package.json, setting up default.
[script:SA-ITOA.apifilesave]
match = SA-ITOA/v1/files
handler = rest_imports_apifilesave_SA_ITOA.FilesaveRestHandler
requireAuthentication = true
scripttype = python


 ## capabilities are not defined in package.json, setting up default.
[script:SA-ITOA.apiiconcollection]
match = SA-ITOA/v1/icon_collection
handler = rest_imports_apiiconcollection_SA_ITOA.IconCollectionRestHandler
requireAuthentication = true
scripttype = python

