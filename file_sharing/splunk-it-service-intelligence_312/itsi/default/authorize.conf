###### ITSI authorize.conf ######

[capability::edit_itsi_modules_conf]
disabled = 0

#####################
## Roles
#####################

## Splunk Admin
## The Splunk admin role inherits itoa_admin;itoa_analyst;itoa_user;power;user roles
## This allows users associated with the admin role to administer itoa out of the box
[role_admin]
importRoles = itoa_admin;itoa_analyst;itoa_user;power;user

## increase disk quota for admin role to 25GB
srchDiskQuota = 25000


## ITOA Admin
## The ITOA admin role inherits itoa_analyst;power;itoa_user;user roles
## This allows users assigned to the itoa_admin role to perform all capabilities of an itoa_team_admin, itoa_analyst and itoa_user
[role_itoa_admin]
importRoles = itoa_team_admin;power;user;metric_ad_admin

edit_itsi_modules_conf = enabled

## Core dependent capabilities
# Capabilities copied from Splunk admin role to enable write permissions
list_storage_passwords = enabled

# Add capability to lookup settings (regular and search head)
# Search head configuration is used by ITSI modular inputs
list_search_head_clustering = enabled
list_settings = enabled

rtsearch = enabled

# For event management
edit_token_http = enabled

## ITSI specific/controlled capabilities

# Notable Event Rules Engine
read_itsi_notable_aggregation_policy = enabled
write_itsi_notable_aggregation_policy = enabled
delete_itsi_notable_aggregation_policy = enabled
interact_with_itsi_notable_aggregation_policy = enabled

# Set Role Based Access Control
configure_perms = enabled

# Glass Table
read_itsi_glass_table = enabled
write_itsi_glass_table = enabled
delete_itsi_glass_table = enabled
interact_with_itsi_glass_table = enabled

# Deep Dive
read_itsi_deep_dive = enabled
write_itsi_deep_dive = enabled
delete_itsi_deep_dive = enabled
interact_with_itsi_deep_dive = enabled
read_itsi_deep_dive_context = enabled
write_itsi_deep_dive_context = enabled
delete_itsi_deep_dive_context = enabled
interact_with_itsi_deep_dive_context = enabled

# Homeview
read_itsi_homeview = enabled
write_itsi_homeview = enabled
delete_itsi_homeview = enabled
interact_with_itsi_homeview = enabled

# Event Management State
read_itsi_event_management_state = enabled
write_itsi_event_management_state = enabled
delete_itsi_event_management_state = enabled

# Temporary KPI
read_itsi_temporary_kpi = enabled
write_itsi_temporary_kpi = enabled
delete_itsi_temporary_kpi = enabled

# Service
read_itsi_service = enabled
write_itsi_service = enabled
delete_itsi_service = enabled

# Service Template
read_itsi_base_service_template = enabled
write_itsi_base_service_template = enabled
delete_itsi_base_service_template = enabled

# Backup Restore
read_itsi_backup_restore = enabled
write_itsi_backup_restore = enabled
delete_itsi_backup_restore = enabled

# KPI Threshold Template
read_itsi_kpi_threshold_template = enabled
write_itsi_kpi_threshold_template = enabled
delete_itsi_kpi_threshold_template = enabled
create_external_ticket = enabled

# KPI Base Searches
read_itsi_kpi_base_search = enabled
write_itsi_kpi_base_search = enabled
delete_itsi_kpi_base_search = enabled

# Correlation Search
read_itsi_correlation_search = enabled
write_itsi_correlation_search = enabled
delete_itsi_correlation_search = enabled
interact_with_itsi_correlation_search = enabled

# Notable Events
read-notable_event = enabled
# Note that index delete settings (delete_by_keyword) is closely tied to
# write-notable_event and delete-notable_event capabilities
write-notable_event = enabled
delete-notable_event = enabled

# Notable Event actions
read-notable_event_action = enabled
execute-notable_event_action = enabled

# Notable Events Status Transition
# Status: 0-Unassigned, 1-New, 2-InProgress, 3-Pending, 4-Resolved, 5-Closed
transition_status-0_to_1-notable_event = enabled
transition_status-0_to_2-notable_event = enabled
transition_status-0_to_3-notable_event = enabled
transition_status-0_to_4-notable_event = enabled
transition_status-0_to_5-notable_event = enabled
transition_status-1_to_0-notable_event = enabled
transition_status-1_to_2-notable_event = enabled
transition_status-1_to_3-notable_event = enabled
transition_status-1_to_4-notable_event = enabled
transition_status-1_to_5-notable_event = enabled
transition_status-2_to_0-notable_event = enabled
transition_status-2_to_1-notable_event = enabled
transition_status-2_to_3-notable_event = enabled
transition_status-2_to_4-notable_event = enabled
transition_status-2_to_5-notable_event = enabled
transition_status-3_to_0-notable_event = enabled
transition_status-3_to_1-notable_event = enabled
transition_status-3_to_2-notable_event = enabled
transition_status-3_to_4-notable_event = enabled
transition_status-3_to_5-notable_event = enabled
transition_status-4_to_0-notable_event = enabled
transition_status-4_to_1-notable_event = enabled
transition_status-4_to_2-notable_event = enabled
transition_status-4_to_3-notable_event = enabled
transition_status-4_to_5-notable_event = enabled
transition_status-5_to_0-notable_event = enabled
transition_status-5_to_1-notable_event = enabled
transition_status-5_to_2-notable_event = enabled
transition_status-5_to_3-notable_event = enabled
transition_status-5_to_4-notable_event = enabled

# Maintenance Services
read-maintenance_calendar = enabled
write-maintenance_calendar = enabled
delete-maintenance_calendar = enabled

# ITSI Module Interface
read-module_interface = enabled
write-module_interface = enabled
delete-module_interface = enabled

## SA-Utils
edit_postprocess = enabled
edit_per_panel_filters = enabled

# Capability for CSV Import mod input
edit_modinput_itsi_csv_import = enabled

## ITOA Team Admin
## The ITOA team admin role inherits itoa_analyst;power;itoa_user;user roles
## This allows users assigned to the role itoa_team_admin role to perform all capabilities of a itoa_analyst and itoa_user
[role_itoa_team_admin]
importRoles = itoa_analyst;power;user;metric_ad_admin

## Core dependent capabilities
# Capabilities copied from Splunk admin role to enable write permissions
list_storage_passwords = enabled

# Add capability to lookup settings (regular and search head)
# Search head configuration is used by ITSI modular inputs
list_search_head_clustering = enabled
list_settings = enabled

rtsearch = enabled

# For event management
edit_token_http = enabled

## ITSI specific/controlled capabilities

# Notable Event Rules Engine
read_itsi_notable_aggregation_policy = enabled
write_itsi_notable_aggregation_policy = enabled
delete_itsi_notable_aggregation_policy = enabled
interact_with_itsi_notable_aggregation_policy = enabled

# Set Role Based Access Control
configure_perms = enabled

# Glass Table
read_itsi_glass_table = enabled
write_itsi_glass_table = enabled
delete_itsi_glass_table = enabled
interact_with_itsi_glass_table = enabled

# Deep Dive
read_itsi_deep_dive = enabled
write_itsi_deep_dive = enabled
delete_itsi_deep_dive = enabled
interact_with_itsi_deep_dive = enabled
read_itsi_deep_dive_context = enabled
write_itsi_deep_dive_context = enabled
delete_itsi_deep_dive_context = enabled
interact_with_itsi_deep_dive_context = enabled

# Homeview
read_itsi_homeview = enabled
write_itsi_homeview = enabled
delete_itsi_homeview = enabled
interact_with_itsi_homeview = enabled

# Event Management State
read_itsi_event_management_state = enabled
write_itsi_event_management_state = enabled
delete_itsi_event_management_state = enabled

# Temporary KPI
read_itsi_temporary_kpi = enabled
write_itsi_temporary_kpi = enabled
delete_itsi_temporary_kpi = enabled

# Service
read_itsi_service = enabled
write_itsi_service = enabled
delete_itsi_service = enabled

# KPI Threshold Template
read_itsi_kpi_threshold_template = enabled
write_itsi_kpi_threshold_template = enabled
delete_itsi_kpi_threshold_template = enabled
create_external_ticket = enabled

# KPI Base Searches
read_itsi_kpi_base_search = enabled
write_itsi_kpi_base_search = enabled
delete_itsi_kpi_base_search = enabled

# Correlation Search
read_itsi_correlation_search = enabled
write_itsi_correlation_search = enabled
delete_itsi_correlation_search = enabled
interact_with_itsi_correlation_search = enabled

# Notable Events
read-notable_event = enabled
# Note that index delete settings (delete_by_keyword) is closely tied to
# write-notable_event and delete-notable_event capabilities
write-notable_event = enabled
delete-notable_event = enabled

# Service Templates
read_itsi_base_service_template = enabled

# Notable Event actions
read-notable_event_action = enabled
execute-notable_event_action = enabled

# Notable Events Status Transition
# Status: 0-Unassigned, 1-New, 2-InProgress, 3-Pending, 4-Resolved, 5-Closed
transition_status-0_to_1-notable_event = enabled
transition_status-0_to_2-notable_event = enabled
transition_status-0_to_3-notable_event = enabled
transition_status-0_to_4-notable_event = enabled
transition_status-0_to_5-notable_event = enabled
transition_status-1_to_0-notable_event = enabled
transition_status-1_to_2-notable_event = enabled
transition_status-1_to_3-notable_event = enabled
transition_status-1_to_4-notable_event = enabled
transition_status-1_to_5-notable_event = enabled
transition_status-2_to_0-notable_event = enabled
transition_status-2_to_1-notable_event = enabled
transition_status-2_to_3-notable_event = enabled
transition_status-2_to_4-notable_event = enabled
transition_status-2_to_5-notable_event = enabled
transition_status-3_to_0-notable_event = enabled
transition_status-3_to_1-notable_event = enabled
transition_status-3_to_2-notable_event = enabled
transition_status-3_to_4-notable_event = enabled
transition_status-3_to_5-notable_event = enabled
transition_status-4_to_0-notable_event = enabled
transition_status-4_to_1-notable_event = enabled
transition_status-4_to_2-notable_event = enabled
transition_status-4_to_3-notable_event = enabled
transition_status-4_to_5-notable_event = enabled
transition_status-5_to_0-notable_event = enabled
transition_status-5_to_1-notable_event = enabled
transition_status-5_to_2-notable_event = enabled
transition_status-5_to_3-notable_event = enabled
transition_status-5_to_4-notable_event = enabled

# Maintenance Services
read-maintenance_calendar = enabled
write-maintenance_calendar = enabled
delete-maintenance_calendar = enabled

# ITSI Module Interface
read-module_interface = enabled
write-module_interface = enabled
delete-module_interface = enabled

## SA-Utils
edit_postprocess = enabled
edit_per_panel_filters = enabled

## ITOA Analyst
## The ITOA analyst role inherits power;itoa_user;user roles
## This allows users assigned to the itoa_analyst role to perform all capabilities of a power Splunk user as well as itoa_user
## The itoa_analyst role can own notable events and perform all transitions
[role_itoa_analyst]
importRoles = itoa_user;power;user;user_ad_user

## Core dependent capabilities
list_storage_passwords = enabled

rtsearch = enabled

# For event management
edit_token_http = enabled

## ITSI specific/controlled capabilities

# Glass Table
read_itsi_glass_table = enabled
write_itsi_glass_table = enabled
delete_itsi_glass_table = enabled
interact_with_itsi_glass_table = enabled

# Deep Dive
read_itsi_deep_dive = enabled
write_itsi_deep_dive = enabled
delete_itsi_deep_dive = enabled
interact_with_itsi_deep_dive = enabled
read_itsi_deep_dive_context = enabled
write_itsi_deep_dive_context = enabled
delete_itsi_deep_dive_context = enabled
interact_with_itsi_deep_dive_context = enabled

# Service
read_itsi_service = enabled

# Service Template
read_itsi_base_service_template = enabled

# KPI Threshold Template
read_itsi_kpi_threshold_template = enabled

# KPI Base Searches
read_itsi_kpi_base_search = enabled

# Homeview
read_itsi_homeview = enabled
write_itsi_homeview = enabled
delete_itsi_homeview = enabled
interact_with_itsi_homeview = enabled

# Event Management State
read_itsi_event_management_state = enabled
write_itsi_event_management_state = enabled
delete_itsi_event_management_state = enabled

# Temporary KPI
read_itsi_temporary_kpi = enabled
write_itsi_temporary_kpi = enabled
delete_itsi_temporary_kpi = enabled

# Correlation Search
read_itsi_correlation_search = enabled

# Notable Event Rules Engine
read_itsi_notable_aggregation_policy = enabled

# Notable Events
read-notable_event = enabled
# Note that index delete settings (delete_by_keyword) is closely tied to
# write-notable_event and delete-notable_event capabilities
write-notable_event = enabled
delete-notable_event = enabled

# Notable Event actions
read-notable_event_action = enabled
execute-notable_event_action = enabled

# Notable Events Status Transition
# Status: 0-Unassigned, 1-New, 2-InProgress, 3-Pending, 4-Resolved, 5-Closed
transition_status-0_to_1-notable_event = enabled
transition_status-0_to_2-notable_event = enabled
transition_status-0_to_3-notable_event = enabled
transition_status-0_to_4-notable_event = enabled
transition_status-0_to_5-notable_event = enabled
transition_status-1_to_0-notable_event = enabled
transition_status-1_to_2-notable_event = enabled
transition_status-1_to_3-notable_event = enabled
transition_status-1_to_4-notable_event = enabled
transition_status-1_to_5-notable_event = enabled
transition_status-2_to_0-notable_event = enabled
transition_status-2_to_1-notable_event = enabled
transition_status-2_to_3-notable_event = enabled
transition_status-2_to_4-notable_event = enabled
transition_status-2_to_5-notable_event = enabled
transition_status-3_to_0-notable_event = enabled
transition_status-3_to_1-notable_event = enabled
transition_status-3_to_2-notable_event = enabled
transition_status-3_to_4-notable_event = enabled
transition_status-3_to_5-notable_event = enabled
transition_status-4_to_0-notable_event = enabled
transition_status-4_to_1-notable_event = enabled
transition_status-4_to_2-notable_event = enabled
transition_status-4_to_3-notable_event = enabled
transition_status-4_to_5-notable_event = enabled
transition_status-5_to_0-notable_event = enabled
transition_status-5_to_1-notable_event = enabled
transition_status-5_to_2-notable_event = enabled
transition_status-5_to_3-notable_event = enabled
transition_status-5_to_4-notable_event = enabled

# Maintenance Services
read-maintenance_calendar = enabled

## ITOA User
## The ITOA user role inherits user role
## This allows users assigned to the itoa_user role to perform all capabilities of a Splunk user
## The itoa_user role can also perform RT search
[role_itoa_user]
importRoles = user;user_ad_user

## Core dependent capabilities
list_storage_passwords = enabled
rtsearch = enabled

# For event management
edit_token_http = enabled

## ITSI specific/controlled capabilities

# Glass Table
read_itsi_glass_table = enabled

# Deep Dive
read_itsi_deep_dive = enabled
read_itsi_deep_dive_context = enabled
write_itsi_deep_dive_context = enabled
delete_itsi_deep_dive_context = enabled

# Service
read_itsi_service = enabled

# Service Template
read_itsi_base_service_template = enabled

# KPI Threshold Template
read_itsi_kpi_threshold_template = enabled

# KPI Base Searches
read_itsi_kpi_base_search = enabled

# Homeview
read_itsi_homeview = enabled
write_itsi_homeview = enabled
delete_itsi_homeview = enabled

# Event Management State
read_itsi_event_management_state = enabled
write_itsi_event_management_state = enabled
delete_itsi_event_management_state = enabled

# Temporary KPI
read_itsi_temporary_kpi = enabled
write_itsi_temporary_kpi = enabled
delete_itsi_temporary_kpi = enabled

# Correlation Search
read_itsi_correlation_search = enabled

# Notable Events
read-notable_event = enabled

# Notable Event actions
read-notable_event_action = enabled

# Maintenance Services
read-maintenance_calendar = enabled
