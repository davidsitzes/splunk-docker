webpackJsonp([38],{0:function(e,t,n){function a(e){return e&&e.__esModule?e:{default:e}}n.p=function(){function e(){for(var e,n,a="",i=0,r=arguments.length;i<r;i++)e=arguments[i].toString(),n=e.length,n>1&&"/"==e.charAt(n-1)&&(e=e.substring(0,n-1)),a+="/"!=e.charAt(0)?"/"+e:e;if("/"!=a){var l=a.split("/"),o=l[1];if("static"==o||"modules"==o){var s=a.substring(o.length+2,a.length);a="/"+o,window.$C.BUILD_NUMBER&&(a+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(a+="."+window.$C.BUILD_PUSH_NUMBER),"app"==l[2]&&(a+=":"+t("APP_BUILD",0)),a+="/"+s}}var u=t("MRSPARKLE_ROOT_PATH","/"),c=t("DJANGO_ROOT_PATH",""),d=t("LOCALE","en-US"),f="";return f=c&&a.substring(0,c.length)===c?a.replace(c,c+"/"+d.toLowerCase()):"/"+d+a,""==u||"/"==u?f:u+f}function t(e,t){if(window.$C&&window.$C.hasOwnProperty(e))return window.$C[e];if(void 0!==t)return t;throw new Error("getConfigValue - "+e+" not set, no default provided")}return e("/static/app/itsi/build/pages")+"/"}(),n(1750),n(1954),n(3026);var i=n(458),r=a(i),l=n(463),o=a(l),s=n(3027),u=a(s),c=n(3211),d=a(c),f=n(910),p=a(f),h=new u.default,g=h.getContainerElement();o.default.render(r.default.createElement(d.default,{ModelClass:p.default}),g)},3211:function(e,t,n){(function(a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(479),l=i(r),o=n(482),s=i(o),u=n(483),c=i(u),d=n(484),f=i(d),p=n(485),h=i(p),g=n(458),_=i(g),m=n(152),v=n(2996),y=n(3104),C=i(y),k=n(1739),b=i(k),w=n(2277),x=i(w),E=n(271),S=i(E),j=n(909),M=i(j),O=n(3107),T=i(O),P=n(3121),R=i(P),F=n(3212),L=i(F),D=n(3218),A=i(D),U=n(3219),B=i(U),V=n(3220),I=i(V),N=n(3201),W=n(129),q=i(W),$=n(237),G=i($);n(591);var H=function(e){function t(e,n){(0,s.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e,n));return a.customColumns=[{key:"linked_services",label:gettext("Linked Services"),content:function(e,t){return _.default.createElement(b.default,{to:t.getEditUrl(e,"linkedServices")},e.linked_services?e.linked_services.length:0)}},{key:"sync_status",label:gettext("Sync Status"),content:N.syncStatusColumn},{key:"entity_rules",label:gettext("Entity Rules"),content:N.entityRulesCountColumn},{key:"kpis",label:gettext("KPIs"),content:N.KPIsCountColumn},{key:"team",label:gettext("Team"),content:N.teamColumn}],(0,m.extend)(a.state.permissions,{canEditPermissions:!1,canBulkChangeStatus:!1,canBulkDelete:!1,canBulkEditPermissions:!1,canChangePerms:!1,canChangeStatus:!1}),a}return(0,h.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){this.fetchGlobalTeam()}},{key:"getEditUrl",value:function(e,t){var n="kpi";return t&&(n=t),"service_template_detail_view#"+e._key+"/"+n}},{key:"fetchGlobalTeam",value:function(){var e=this;a((new S.default).url+"/"+G.default.GLOBAL_SECURITY_GROUP_KEY,v.defaultFetchInit).then((0,v.handleResponse)(200)).then(function(t){var n=!0;t.permissions&&t.permissions.write===!1&&(n=!1),e.setState({permissions:(0,m.extend)(e.state.permissions,{canCreate:n,canBulkDelete:n})})}).catch(function(t){e.handleError(gettext("Fetch global team model failed."),t)})}},{key:"getExpansionRowCustom",value:function(e,t){return _.default.createElement(x.default.Row,{key:e._key+"-expansion"},_.default.createElement(x.default.Cell,{style:{borderTop:"none"},colSpan:t},e.description,_.default.createElement(C.default,null,_.default.createElement(C.default.Term,null,gettext("Entity Rules")),_.default.createElement(C.default.Description,null,e.entity_rules?e.entity_rules.length:0),_.default.createElement(C.default.Term,null,gettext("KPIs")),_.default.createElement(C.default.Description,null,e.kpis?e.kpis.length:0),e.last_sync_error&&!q.default.isEmptyString(e.last_sync_error)&&_.default.createElement("span",null,_.default.createElement(C.default.Term,null,gettext("Last sync error")),_.default.createElement(C.default.Description,null,e.last_sync_error)))))}},{key:"render",value:function(){return this.state.errorMessage?this.renderErrorModal():_.default.createElement(T.default,{objectNamePlural:this.objectNamePlural,objectNameSingular:this.objectNameSingular,objectsCollectionPath:(new M.default).url,objectCollectionFields:"_key,title,identifying_name,description,sec_grp,linked_services,entity_rules,last_sync_error,kpis._key,kpis.type,sync_status,scheduled_time",headerDescription:gettext("Viewer for all service templates"),getObjectsCollectionFetchData:this.getObjectsCollectionFetchData,getObjectsCountFetchData:this.getObjectsCountFetchData,getExpansionRow:this.getExpansionRowCustom,getEditUrl:this.getEditUrl,idAttribute:this.idAttribute,isDefaultObject:this.isDefaultObject,nameAttribute:this.nameAttribute,nameSortAttribute:this.nameSortAttribute,permissions:this.state.permissions,errorFormatter:this.errorFormatter,ModalClone:A.default,ModalNew:L.default,ModalEdit:"redirect",ModalEditTitleOrDescription:B.default,ModalDelete:I.default,showAppColumn:!1,showOwnerColumn:!1,showSharingColumn:!1,showStatusColumn:!1,showAppFilter:!1,showOwnerFilter:!1,customColumns:this.customColumns})}}]),t}(R.default);t.default=H,e.exports=t.default}).call(t,n(2995))},3212:function(e,t,n){(function(a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r,l,o=n(130),s=i(o),u=n(479),c=i(u),d=n(482),f=i(d),p=n(483),h=i(p),g=n(484),_=i(g),m=n(485),v=i(m),y=n(458),C=i(y),k=n(490),b=i(k),w=n(152),x=n(494),E=i(x),S=n(2559),j=i(S),M=n(1739),O=i(M),T=n(505),P=i(T),R=n(511),F=i(R),L=n(3043),D=i(L),A=n(2283),U=i(A),B=n(1731),V=i(B),I=n(1723),N=n(2996),W=n(3213),q=i(W),$=n("shim/splunk.util"),G=i($),H=n(129),K=i(H),z=n(231),J=i(z),Y=n(909),Q=i(Y),X=n(3214),Z=i(X);n(591);var ee=(new J.default).url,te=(new Q.default).url,ne=(l=r=function(e){function t(e,n){(0,f.default)(this,t);var i=(0,_.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.handleSuccess=function(e){i.handleClose(),window.location.href=G.default.make_url(["app","itsi","service_template_detail_view#"+e+"/entities"].join("/"))},i.handleError=function(e,t){t&&t.text&&"function"==typeof t.text?t.text().then(function(n){var a=t;a.responseText=n,i.setState({isWorking:!1,errorMessage:i.props.errorFormatter(e,a)})}):i.setState({isWorking:!1,errorMessage:e})},i.handleClose=function(){i.setState({isWorking:!1,errorMessage:""}),i.props.handleRequestClose()},i.handleSave=function(){i.setState({isWorking:!0});var e=""+te;if(""===i.state.title)return void i.handleError(gettext("Must provide a title."));if(""===i.state.service_id)return void i.handleError(gettext("Must select a service to generate template from."));var t=(0,w.extend)(i.props.object,{description:i.state.description,title:i.state.title,service_id:i.state.service_id,sec_grp:"default_itsi_security_group"}),n=(0,w.create)(N.defaultFetchInit);n.method="POST",n.headers["Content-Type"]="application/json",n.body=(0,s.default)(t),a(""+e,n).then((0,N.handleResponse)(200)).then(function(e){i.handleSuccess(e._key)}).catch(function(e){i.handleError((0,I.sprintf)(gettext("Could not create %s."),i.props.objectNameSingular.toLowerCase()),e)})},i.handleTitleTextChange=function(e,t){var n=t.value;i.setState({title:n})},i.handleDescriptionTextChange=function(e,t){var n=t.value;i.setState({description:n})},i.handleServiceChange=function(e){i.setState({service_id:e})},i.state={title:"",description:"",service_id:"",isWorking:!1},i}return(0,v.default)(t,e),(0,h.default)(t,[{key:"componentWillReceiveProps",value:function(){this.setState({isWorking:!1})}},{key:"render",value:function(){var e=this.props,t=e.objectNameSingular,n=e.open,a="/help?location=%5Bitsi%3A"+K.default.getAppVersionString()+"%5Dapp.itsi.create_service_template";return C.default.createElement(F.default,{onRequestClose:this.handleClose,open:n,style:{width:"400px"}},C.default.createElement(F.default.Header,{title:(0,I.sprintf)(gettext("Create %s"),t),onRequestClose:this.handleClose}),C.default.createElement(F.default.Body,null,this.state.errorMessage&&C.default.createElement(P.default,{type:"error"},this.state.errorMessage),C.default.createElement(D.default,{style:{marginBottom:"0"}},gettext("Choose a service to generate a template from. The service's properties and content will be cloned into the new template. ")),C.default.createElement(O.default,{to:a,openInNewContext:!0},gettext("Learn more")),C.default.createElement(P.default,{type:"warning"},gettext("Services with a"),C.default.createElement(q.default,{style:{margin:"3px"}}),gettext("icon are already linked to a service template. Selecting a service that is already linked will unlink it from its current template and link it to the newly created one.")),C.default.createElement(j.default,{label:gettext("Service")},C.default.createElement(Z.default,{objectsCollectionPath:ee,placeholder:gettext("Select a service"),handleSelectorChange:this.handleServiceChange,lockField:"base_service_template_id"})),C.default.createElement(j.default,{label:gettext("Title")},C.default.createElement(V.default,{canClear:!0,placeholder:gettext("Template title"),onChange:this.handleTitleTextChange})),C.default.createElement(j.default,{label:gettext("Description")},C.default.createElement(V.default,{canClear:!0,placeholder:gettext("optional"),onChange:this.handleDescriptionTextChange})),C.default.createElement(j.default,{label:gettext("Team"),tooltip:gettext("Team to associate with")},C.default.createElement(U.default,null,gettext("Global")))),C.default.createElement(F.default.Footer,null,C.default.createElement(E.default,{onClick:this.handleClose,label:gettext("Cancel")}),C.default.createElement(E.default,{appearance:"primary",disabled:this.state.isWorking,onClick:this.handleSave,label:this.state.isWorking?gettext("Creating..."):gettext("Create")})))}}]),t}(y.Component),r.propTypes={open:b.default.bool.isRequired,object:b.default.object.isRequired,objects:b.default.array.isRequired,objectNameSingular:b.default.string.isRequired,errorFormatter:b.default.func.isRequired,handleRequestClose:b.default.func.isRequired},l);t.default=ne,e.exports=t.default}).call(t,n(2995))},3213:function(e,t,n){e.exports=function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=79)}({0:function(e,t){e.exports=n(458)},1:function(e,t){e.exports=n(500)},2:function(e,t){e.exports=n(503)},79:function(e,t,n){"use strict";function a(e){return r.a.createElement(s.a,u({screenReaderText:Object(l._)("Lock"),viewBox:"0 0 1332 1500"},e),r.a.createElement("path",{d:"M1130.068 686.15h126.69c21.62 0 39.526 7.093 53.715 21.282 14.19 14.19 21.284 32.095 21.284 53.717V1425c0 21.622-7.095 39.527-21.284 53.716-14.19 14.19-32.095 21.284-53.716 21.284H75c-21.622 0-39.527-7.095-53.716-21.284C7.094 1464.526 0 1446.622 0 1425V761.15c0-21.623 7.095-39.528 21.284-53.718C35.474 693.242 53.378 686.15 75 686.15h126.69V464.19c0-83.11 20.945-160.305 62.837-231.59C306.42 161.32 363.007 104.73 434.29 62.84 505.575 20.946 582.77 0 665.88 0s160.304 20.946 231.588 62.838c71.284 41.892 127.872 98.48 169.764 169.763 41.892 71.285 62.838 148.48 62.838 231.59v221.96zm-222.973 0l1.013-221.96c.676-65.54-23.142-122.298-71.453-170.27-48.31-47.974-105.236-71.96-170.777-71.96-65.54 0-122.297 23.986-170.27 71.96-47.973 47.972-71.96 104.73-71.96 170.27v221.96h483.447z"}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var i=n(0),r=n.n(i),l=n(1),o=(n.n(l),n(2)),s=n.n(o),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}}})},3214:function(e,t,n){(function(a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r,l,o=n(2497),s=i(o),u=n(479),c=i(u),d=n(482),f=i(d),p=n(483),h=i(p),g=n(484),_=i(g),m=n(485),v=i(m),y=n(458),C=i(y),k=n(490),b=i(k),w=n(3215),x=i(w),E=n(1730),S=i(E),j=n(3213),M=i(j),O=n(2996),T=n(1363),P=i(T);n(591);var R=(l=r=function(e){function t(e,n){(0,f.default)(this,t);var i=(0,_.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e,n));return i.handleChange=function(e,t){var n=t.value;i.setState({object_id:n,keyword:""}),i.props.handleSelectorChange(n)},i.handleFetch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";i.setState({keyword:e,isLoading:!0});var t=i.props.objectsCollectionPath,n="_key,title,identifying_name";i.state.showLock&&(n+=","+i.props.lockField);var r={count:100,fields:n,sort_key:"identifying_name",sort_dir:"asc",offset:0,filter:'{"identifying_name":{"$regex":"'+e.toLowerCase()+'.*"}}'};a(t+"?"+P.default.stringify(r),O.defaultFetchInit).then((0,O.handleResponse)(200)).then(function(e){i.setState({isLoading:!1,options:e})}).catch(i.onError)},i.onError=function(e){i.setState({error:!0}),console.log(e)},i.handleFilterChange=function(e,t){var n=t.keyword;i.handleFetch(n)},i.generateOptions=function(){var e=void 0;if(i.state.service_id){var t=i.createOption(i.state.service_id);e=i.createOption(t,!0)}if(i.state.isLoading)return e;var n=i.state.options.map(function(e){return i.createOption(e)});return e&&n.push(e),n},i.createOption=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return C.default.createElement(S.default.Option,(0,s.default)({label:e.title,value:e._key,key:t?"selected":e._key,hidden:!!t},i.state.showLock&&e[i.props.lockField]&&""!==e[i.props.lockField]&&{icon:C.default.createElement(M.default,null)}))},i.state={keyword:"",object_id:"",isLoading:!1,error:!1,showLock:!1,options:[]},i}return(0,v.default)(t,e),(0,h.default)(t,[{key:"componentDidMount",value:function(){if(this.props.initialValue.title||this.handleFetch(),this.props.initialValue.title){var e=[{title:this.props.initialValue.title,_key:this.props.initialValue._key}];this.setState({options:e,object_id:this.props.initialValue._key})}""!==this.props.lockField&&this.setState({showLock:!0})}},{key:"componentWillMount",value:function(){if(this.props.initialValue.title){var e=[{title:this.props.initialValue.title,_key:this.props.initialValue._key}];this.setState({options:e,object_id:this.props.initialValue._key})}""!==this.props.lockField&&this.setState({showLock:!0})}},{key:"render",value:function(){var e=this.generateOptions();return C.default.createElement(S.default,{value:this.state.object_id,filter:"controlled",placeholder:this.props.placeholder,menuStyle:{width:300},onChange:this.handleChange,onFilterChange:(0,x.default)(this.handleFilterChange,500),isLoadingOptions:this.state.isLoading,error:this.state.error},e)}}]),t}(y.Component),r.propTypes={objectsCollectionPath:b.default.string.isRequired,handleSelectorChange:b.default.func.isRequired,placeholder:b.default.string.isRequired,initialValue:b.default.object,lockField:b.default.string},l);R.defaultProps={initialValue:{title:!1,_key:!1},lockField:""},t.default=R,e.exports=t.default}).call(t,n(2995))},3215:function(e,t,n){function a(e,t,n){function a(t){var n=v,a=y;return v=y=void 0,x=t,k=e.apply(a,n)}function c(e){return x=e,b=setTimeout(p,t),E?a(e):k}function d(e){var n=e-w,a=e-x,i=t-n;return S?u(i,C-a):i}function f(e){var n=e-w,a=e-x;return void 0===w||n>=t||n<0||S&&a>=C}function p(){var e=r();return f(e)?h(e):void(b=setTimeout(p,d(e)))}function h(e){return b=void 0,j&&v?a(e):(v=y=void 0,k)}function g(){void 0!==b&&clearTimeout(b),x=0,v=w=y=b=void 0}function _(){return void 0===b?k:h(r())}function m(){var e=r(),n=f(e);if(v=arguments,y=this,w=e,n){if(void 0===b)return c(w);if(S)return b=setTimeout(p,t),a(w)}return void 0===b&&(b=setTimeout(p,t)),k}var v,y,C,k,b,w,x=0,E=!1,S=!1,j=!0;if("function"!=typeof e)throw new TypeError(o);return t=l(t)||0,i(n)&&(E=!!n.leading,S="maxWait"in n,C=S?s(l(n.maxWait)||0,t):C,j="trailing"in n?!!n.trailing:j),m.cancel=g,m.flush=_,m}var i=n(2894),r=n(3216),l=n(3217),o="Expected a function",s=Math.max,u=Math.min;e.exports=a},3216:function(e,t,n){var a=n(2890),i=function(){return a.Date.now()};e.exports=i},3218:function(e,t,n){(function(a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(130),l=i(r),o=n(479),s=i(o),u=n(482),c=i(u),d=n(484),f=i(d),p=n(485),h=i(p),g=n(1723),m=n(152),v=n(2996),y=n(3113),C=i(y);n(591);var k=function(e){function t(){var e,n,i,r;(0,c.default)(this,t);for(var o=arguments.length,u=Array(o),d=0;d<o;d++)u[d]=arguments[d];return n=i=(0,f.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(u))),i.handleSave=function(){i.setState({isWorking:!0});var e=""+i.props.objectsCollectionPath,t=(0,m.pick)((0,m.clone)(i.props.object),"title","description","sec_grp"),n=(0,m.extend)(t,{description:i.state.description});n[i.props.nameAttribute]=i.state.title,n.base_service_template_id=i.props.object._key;var r=(0,m.create)(v.defaultFetchInit);r.method="POST",r.headers["Content-Type"]="application/json",r.body=(0,l.default)(n),a(""+e,r).then((0,v.handleResponse)(200)).then(function(){i.handleSuccess()}).catch(function(e){i.handleError((0,g.sprintf)(_("Could not clone %s."),i.props.objectNameSingular.toLowerCase()),e)})},r=n,(0,f.default)(i,r)}return(0,h.default)(t,e),t}(C.default);t.default=k,e.exports=t.default}).call(t,n(2995))},3219:function(e,t,n){(function(a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(130),l=i(r),o=n(479),s=i(o),u=n(482),c=i(u),d=n(484),f=i(d),p=n(485),h=i(p),g=n(458),m=(i(g),n(152)),v=n(2996),y=n(1363),C=i(y),k=n(1723),b=n(3113),w=i(b);n(591);var x=function(e){function t(){var e,n,i,r;(0,c.default)(this,t);for(var o=arguments.length,u=Array(o),d=0;d<o;d++)u[d]=arguments[d];return n=i=(0,f.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(u))),i.handleSave=function(){i.setState({isWorking:!0});var e={is_partial_data:1},t={_key:i.props.object[i.props.idAttribute],description:i.state.description,title:i.state.title},n=i.props.objectsCollectionPath+"/"+i.props.object[i.props.idAttribute].split("/").pop()+"\n\t\t\t?"+C.default.stringify(e),r=(0,m.create)(v.defaultFetchInit);r.method="PUT",r.headers["Content-Type"]="application/json",r.body=(0,l.default)(t),a(""+n,r).then((0,v.handleResponse)(200)).then(function(){i.handleSuccess(),i.props.handleUpdateItem(t)}).catch(function(e){i.handleError((0,k.sprintf)(_("Could not edit title or description of %s."),i.props.objectNameSingular.toLowerCase()),e)})},r=n,(0,f.default)(i,r)}return(0,h.default)(t,e),t}(w.default);t.default=x,e.exports=t.default}).call(t,n(2995))},3220:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i,r,l=n(479),o=a(l),s=n(482),u=a(s),c=n(484),d=a(c),f=n(485),p=a(f),h=n(458),g=(a(h),n(3111)),m=a(g);n(591);var v=(r=i=function(e){function t(){return(0,u.default)(this,t),(0,d.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),t}(m.default),i.defaultProps={warningMessage:_("Deleting the template will unlink any services that are linked to it.")},r);t.default=v,e.exports=t.default}});