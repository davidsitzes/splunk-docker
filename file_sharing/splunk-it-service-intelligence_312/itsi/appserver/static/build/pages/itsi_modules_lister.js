webpackJsonp([22],{0:function(e,t,i){var a,r;i.p=function(){function e(){for(var e,i,a="",r=0,n=arguments.length;r<n;r++)e=arguments[r].toString(),i=e.length,i>1&&"/"==e.charAt(i-1)&&(e=e.substring(0,i-1)),a+="/"!=e.charAt(0)?"/"+e:e;if("/"!=a){var s=a.split("/"),o=s[1];if("static"==o||"modules"==o){var l=a.substring(o.length+2,a.length);a="/"+o,window.$C.BUILD_NUMBER&&(a+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(a+="."+window.$C.BUILD_PUSH_NUMBER),"app"==s[2]&&(a+=":"+t("APP_BUILD",0)),a+="/"+l}}var d=t("MRSPARKLE_ROOT_PATH","/"),c=t("DJANGO_ROOT_PATH",""),p=t("LOCALE","en-US"),u="";return u=c&&a.substring(0,c.length)===c?a.replace(c,c+"/"+p.toLowerCase()):"/"+p+a,""==d||"/"==d?u:d+u}function t(e,t){if(window.$C&&window.$C.hasOwnProperty(e))return window.$C[e];if(void 0!==t)return t;throw new Error("getConfigValue - "+e+" not set, no default provided")}return e("/static/app/itsi/build/pages")+"/"}(),a=[i("require/underscore"),i("shim/jquery"),i("util/router_utils"),i(2720),i(2735),i(2731),i(2732),i(2733),i(2472)],r=function(e,t,i,a,r,n,s,o,l){var d={collection:o,model:l,title:e("ITSI Modules").t(),description:e("Viewer for all ITSI Modules").t(),titleView:r,tableCaptionView:n,editMenu:s};new a(d);i.start_backbone_history()}.apply(t,a),!(void 0!==r&&(e.exports=r))},2720:function(e,t,i){var a,r;a=[e,i("require/underscore"),i("shim/jquery"),i(401),i(449),i(450),i(840),i(846),i(2721),i(2723),i(2724),i(2728)],r=function(e,t,i,a,r,n,s,o,l,d,c,p){return a.extend({moduleId:String(e.id),initialize:function(e){a.prototype.initialize.apply(this,arguments),this.pagesCollection.off("do_filter doRegexFilter")},initializeAndRenderViews:function(){this.pagesCollection.fetchXhr.done(function(){var e={read:!0,write:!0,delete:!0};this.pagesView=new r({permissions:e,model:{savedPage:this.pagesModel,clonePage:this.cloneModel,state:this.stateModel,application:this.model.application,appLocal:this.model.appLocal,uiPrefs:this.uiPrefsModel,user:this.model.user},collection:{savedPages:this.pagesCollection,roles:this.rolesCollection},pageTitle:this.pageTitle,pageDescr:this.pageDescr,customViews:{EditMenuView:this.editMenu||n,InfoDetailsView:this.infoDetails||c,TitleView:this.titleView||s,CreateButtonView:this.CreateButtonView||p,TableView:this.tableView||d,TableCaptionView:this.tableCaptionView||o,RowView:this.rowView||l},collectionRender:!0}),this.pageView.$(".main-section-body").append(this.pagesView.render().el)}.bind(this)).fail(function(){console.error("Failed to retrieve list of all modules!")})},sortCollection:function(){this.pagesCollection.setSortDirection(this.stateModel.get("sortDirection")),this.pagesCollection.setSortKey(this.stateModel.get("sortKey")),this.pagesCollection.sort()}})}.apply(t,a),!(void 0!==r&&(e.exports=r))},2721:function(e,t,i){var a,r;a=[i("shim/jquery"),i("require/underscore"),i(149),i(129),i(853),i(2722)],r=function(e,t,i,a,r,n){var s=r.extend({basePackageURL:t.template(["","static","app","SA-ITOA","download","<%- package_filename %>.spl"].join("/")),moduleListerTemplate:t.template(n),_renderWithConvertedTimeZone:function(e,i){this.viewUrl=this.model.savedPage.getViewUrl(),this.$el.html(this.moduleListerTemplate({_:t,title:this.model.savedPage.get("label"),app:this.model.savedPage.get("package_name"),version:this.model.savedPage.get("version"),author:this.model.savedPage.get("author"),owner:e,index:this.options.index,viewUrl:this.viewUrl,last_exported_date:i}))},_formatLastExportedDate:function(e){if(this.model.savedPage.get("is_read_only"))return t("N/A").t();var r=this.model.savedPage.get("last_exported_date");return r?(r=i.convertUtcDateToTimezoneDate(a.convertBackendDate(r),1e3*e.get("offset")),i.getLocalizedDate(r)):t("Never").t()},renderRow:function(e){this.options.enableBulkActions&&this.$(".box").append(this.children.bulkbox.render().el);var t=this._formatLastExportedDate(this.model.savedPage.get("userTimezone"));this._renderWithConvertedTimeZone(e,t)}});return s}.apply(t,a),!(void 0!==r&&(e.exports=r))},2722:function(e,t){e.exports='<td class="expands">\n    <a href="#">\n    \t<i class="icon-triangle-right-small"></i>\n    </a>\n</td>\n<td class="title">\n\t<a href=<%- viewUrl%> class="edit-row"><%- title %></a>\n</td>\n<td class="actions"></td>\n<td class="current-version"><%- version%></td>\n<td class="module-developer"><%- author%></td>\n<td class="last-exported-date"><%- last_exported_date %></td>'},2723:function(e,t,i){var a,r;a=[i("require/underscore"),i(857)],r=function(e,t){return t.extend({initialize:function(i){i.extraHeaders=[{label:e("Current Version").t(),className:"col-current-version"},{label:e("Module Developer").t(),className:"col-module-developer"},{label:e("Last Exported").t(),className:"col-last-exported-date"}],i.enableActions=!0,t.prototype.initialize.apply(this,arguments)}})}.apply(t,a),!(void 0!==r&&(e.exports=r))},2724:function(e,t,i){var a,r;a=[i("require/underscore"),i("util/splunkd_utils"),i(839),i(2725),i(2726)],r=function(e,t,i,a){var r=i.extend({className:"list-dotted module-lister-details-dotted",OBJECT_TYPE_MAPPING:{kpi_group:e("KPI Groups").t(),kpis:e("KPIs").t(),kpi_base_search:e("Base Searches").t(),service_template:e("Service Templates").t(),entity_source_template:e("Entity Discovery Searches").t()},initialize:function(){i.prototype.initialize.apply(this,arguments)},_getMappedObjectTypes:function(){var t={},i=this.model.savedPage.get("counts")?this.model.savedPage.get("counts").attributes:[],a=e.pick(i,e.keys(this.OBJECT_TYPE_MAPPING));return e.each(a,function(e,i){t[this.OBJECT_TYPE_MAPPING[i]]=e},this),t},render:function(){var i,a,r,n=this.model.savedPage.hasAcl,s=this.model.savedPage.get("package_name"),o=this._getMappedObjectTypes();if(n){var l=this.model.savedPage.get("acl").sharing;i=this.model.savedPage.get("acl").owner,a=t.getPermissionLabel(l,i),r=this.model.savedPage.get("acl").can_change_perms}return this.$el.html(this.infoTemplate({_:e,objectCounts:o,owner:i,permissionString:a,canChangePerms:r,appString:s,hasAcl:n,canUseApps:!0})),this},infoTemplate:e.template(a)});return r}.apply(t,a),!(void 0!==r&&(e.exports=r))},2725:function(e,t){e.exports='<% if(canUseApps) { %>\n\t<dt class="app"><%- _("App").t() %></dt>\n\t<dd><%- appString %></dd>\n<% } %>\n<% if(hasAcl) { %>\n\t<dt class="owner"><%- _("Owner").t() %></dt>\n\t<dd><%- owner %></dd>\n\t<dt class="permissions"><%- _("Permissions").t() %></dt>\n\t<dd class="edit-permissions"><%- permissionString %></dd>\n<% } %>\n<% _.each(objectCounts, function(value, field) { %>\n\t<dt><%- field %></dt>\n\t<dd><%- value %></dd>\n<% }); %>'},2726:function(e,t,i){var a=i(2727);"string"==typeof a&&(a=[[e.id,a,""]]);i(15)(a,{});a.locals&&(e.exports=a.locals)},2727:function(e,t,i){t=e.exports=i(14)(),t.push([e.id,".module-lister-details-dotted dt{width:155px}.last-exported{margin-right:3%}",""])},2728:function(e,t,i){var a,r;a=[i("require/underscore"),i("shim/jquery"),i(841),i(2729),i(2730)],r=function(e,t,i,a,r){var n=i.extend({events:{"click .add-page":function(e){e.preventDefault();var i=new a({model:{savedPage:this.model.savedPage},collection:this.collection,onHiddenRemove:!0});t("body").append(i.render().$el),i.show()}},_template:e.template(r)});return n}.apply(t,a),!(void 0!==r&&(e.exports=r))},2729:function(e,t,i){var a,r;a=[i("require/underscore"),i("require/backbone"),i("shim/jquery"),i("shim/splunk.util"),i("views/shared/Modal"),i("views/shared/FlashMessagesLegacy"),i("views/shared/controls/ControlGroup"),i("collections/shared/FlashMessages"),i(129)],r=function(e,t,i,a,r,n,s,o,l){var d=r.extend({REGEX_SPACES:/\s/g,REGEX_SPECIAL_CHARACTERS:/[^(\w|\d|\-)]+/g,events:{"click .modal-btn-primary":"createModule","keyup input[name=label]":"sluggifyAppId"},initialize:function(){if(r.prototype.initialize.apply(this,arguments),!this.model.savedPage)throw"Must pass in model.savedPage to ModulesListerAddModalView";if(!(this.model.savedPage instanceof t.Model)){var i=this.model.savedPage;this.model.savedPage=new i(null,{})}this.children.titleControl=new s({controlType:"Text",className:"module-title-control control-group",controlOptions:{modelAttribute:"label",model:this.model.savedPage,save:!1},label:e("Title").t()}),this.children.appIdControl=new s({controlType:"Text",className:"module-appid-control control-group",controlOptions:{modelAttribute:"app_id",model:this.model.savedPage,save:!1},label:e("App ID").t(),tooltip:e('The ID of the application. Module will be saved as "DA-ITSI-<App_Id>"').t(),help:e("Can only contain letters, numbers and underscores.").t()}),this.children.descriptionControl=new s({controlType:"Textarea",controlOptions:{modelAttribute:"description",model:this.model.savedPage,save:!1},label:e("Description").t()}),this.flashMessagesCollection=new o,this.children.flashMessagesView=new n({collection:this.flashMessagesCollection})},createModule:function(t){if(t.preventDefault(),!this.$(r.FOOTER_SELECTOR+" .modal-btn-primary").hasClass("disabled")){this.validationStart();var i=this.model.savedPage.get("app_id");if(l.isEmptyString(i)||null!==i.match(this.REGEX_SPECIAL_CHARACTERS))return this.flashMessagesCollection.reset([{key:"invalidappid",type:"error",html:e("Must provide a valid App ID.").t()}]),void this.validationFinish(!1);var n=this.model.savedPage.get("description");if(l.isEmptyString(n)||null===n)return this.flashMessagesCollection.reset([{key:"invaliddescription",type:"error",html:e("Must provide a valid description.").t()}]),void this.validationFinish(!1);this.model.savedPage.set("package_name",i),this.flashMessagesCollection.reset(),this.model.savedPage.save().done(function(){this.collection.trigger("refresh"),this.hide()}.bind(this)).fail(function(t){this.flashMessagesCollection.reset([{key:"failedmetadatawrite",type:"error",html:a.sprintf(e("Failed to create the new module. Reason: %s").t(),t.responseJSON.message)}]),this.validationFinish(!1)}.bind(this))}},manageCreateButtonControl:function(){0===this.model.savedPage.get("app_id").length?this.$(r.FOOTER_SELECTOR+" .modal-btn-primary").addClass("disabled"):this.$(r.FOOTER_SELECTOR+" .modal-btn-primary").removeClass("disabled")},sluggifyAppId:function(e){var t=i(e.target).val(),a=t.toUpperCase();a=a.replace(this.REGEX_SPACES,"_"),a=a.replace(this.REGEX_SPECIAL_CHARACTERS,""),this.model.savedPage.set("app_id",(a.length>0?"DA-ITSI-":"")+a),this.manageCreateButtonControl()},render:function(){return this.$el.html(r.TEMPLATE),this.$(r.HEADER_TITLE_SELECTOR).html(e("Create Module").t()),this.$(r.BODY_SELECTOR).append(r.FORM_HORIZONTAL),this.$(r.BODY_FORM_SELECTOR).append(this.children.flashMessagesView.render().$el),this.$(r.BODY_FORM_SELECTOR).append(this.children.titleControl.render().$el),this.$(r.BODY_FORM_SELECTOR).append(this.children.appIdControl.render().$el),this.$("input[name=app_id]").attr("disabled","disabled"),this.$(r.BODY_FORM_SELECTOR).append(this.children.descriptionControl.render().$el),this.$(r.FOOTER_SELECTOR).append(r.BUTTON_CANCEL),this.$(r.FOOTER_SELECTOR).find(".modal-btn-cancel").removeClass("pull-left"),this.$(r.FOOTER_SELECTOR).append('<a href="#" class="btn btn-primary modal-btn-primary pull-right">'+e("Create").t()+"</a>"),this.manageCreateButtonControl(),this},validationStart:function(){this.$(r.FOOTER_SELECTOR+" .modal-btn-primary").addClass("disabled"),this.$(r.FOOTER_SELECTOR+" .modal-btn-cancel").addClass("disabled"),this.$(r.FOOTER_SELECTOR+" .modal-btn-primary").text("Creating..."),this.$(".control-group-aliases").removeClass("error"),this.$(".control-group-info").removeClass("error")},validationFinish:function(e){e?this.$(r.FOOTER_SELECTOR+" .modal-btn-primary").text("Created"):(this.$(r.FOOTER_SELECTOR+" .modal-btn-primary").removeClass("disabled"),this.$(r.FOOTER_SELECTOR+" .modal-btn-cancel").removeClass("disabled"),this.$(r.FOOTER_SELECTOR+" .modal-btn-primary").text("Create"))}});return d}.apply(t,a),!(void 0!==r&&(e.exports=r))},2730:function(e,t){e.exports='<div class="add-dashboard-controls pull-right">\n    <a href="#" class="btn btn-primary add-page"><%- _("New Module").t() %></a>\n</div>'},2731:function(e,t,i){var a,r;a=[i("require/underscore"),e,i("shim/jquery"),i(846)],r=function(e,t,i,a){return a.extend({events:{"keyup .search-query":"handleFilter","click .search-query-clear":"resetAllModels"},initialize:function(){a.prototype.initialize.apply(this,arguments),this.collectionFilterClone=new this.collection.constructor(this.collection.models,{moduleName:this.collection.moduleName}),this.model.state.off("change:sortDirection change:sortKey"),this.model.state.on("change:sortDirection change:sortKey",function(e){this.collection.sortCollection(e)}.bind(this))},handleFilter:function(e){var t=i(e.currentTarget).val(),a=this.collectionFilterClone.filter(function(e){return e.get("title").toLowerCase().indexOf(t.toLowerCase())!==-1});this.collection.reset(a),this.collection.sortCollection(this.model.state)},resetAllModels:function(){this.collection.reset(this.collectionFilterClone.models)}})}.apply(t,a),!(void 0!==r&&(e.exports=r))},2732:function(e,t,i){var a,r;a=[i("require/underscore"),e,i("shim/jquery"),i("views/Base"),i("views/shared/delegates/Popdown"),i("views/shared/dialogs/TextDialog"),i("shim/splunk.util"),i("uri/route"),i("models/Base"),i(129),i(473)],r=function(e,t,i,a,r,n,s,o,l,d,c){return a.extend({events:{"click .download-module":"downloadModule"},moduleId:String(t.id),initialize:function(){a.prototype.initialize.apply(this,arguments)},className:"dropdown",render:function(){var t={_:e,savedPage:this.model.savedPage,app:this.model.application.get("app"),view:this.model.savedPage.get("title"),returnTo:encodeURIComponent(window.location.pathname),canWrite:!this.model.savedPage.hasAcl||this.model.savedPage.get("acl").can_write,lastExported:this.model.savedPage.get("last_exported_date"),isReadOnly:this.model.savedPage.get("is_read_only"),modifiable:!this.model.savedPage.hasAcl||this.model.savedPage.get("acl").modifiable,savedPageLink:o.page(this.model.application.get("root"),this.model.application.get("locale"),this.model.application.get("app"),this.model.application.get("name")),savedPageId:this.model.savedPage.id,editUrl:this.model.savedPage.getEditUrl()};return this.$el.html(this.compiledTemplate(t)),this.children.popdown=new r({el:this.$el}),this},downloadModule:function(t){i(t.currentTarget).hasClass("disabled")||this.model.savedPage.downloadModule().done(function(e,t){d.triggerBrowserDownload(e,t)}).fail(function(t){var i=new c({errorMessage:e("Failed to download package! Reason: "+t.message).t()});this.$el.append(i.render.$el),i.show()}.bind(this))},template:'\t\t\t\t\t<a class="dropdown-toggle" href="#"><%- _("Actions").t() %><span class="caret"></span></a>\t\t\t\t\t<div class="dropdown-menu dropdown-menu-narrow">\t\t\t\t\t\t<div class="arrow"></div>\t\t\t\t\t\t<% if(canWrite) { %>\t\t\t\t\t\t\t<ul class="first-group">\t\t\t\t\t\t\t\t<% if (!isReadOnly) { %>\t\t\t\t\t\t\t\t\t<li><a href="<%- editUrl %>" class="edit"><%- _("Edit").t() %> </a></li>\t\t\t\t\t\t\t\t\t<% if (lastExported !== 0) { %>\t\t\t\t\t\t\t\t\t\t<li><a class="download-module"><%- _("Download last exported package").t() %></a></li>\t\t\t\t\t\t\t\t\t<% } else { %>\t\t\t\t\t\t\t\t\t\t<li><a class="download-module disabled"><%- _("Download last exported package").t() %></a></li>\t\t\t\t\t\t\t\t\t<% } %>\t\t\t\t\t\t\t\t<% } else { %>\t\t\t\t\t\t\t\t\t<li><a href="<%- editUrl %>" class="edit"><%- _("View").t() %></a></li>\t\t\t\t\t\t\t\t<% } %>\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t<% } %>\t\t\t\t\t</div>\t\t\t\t'})}.apply(t,a),!(void 0!==r&&(e.exports=r))},2735:function(e,t,i){var a,r;a=[e,i(840),i(2736)],r=function(e,t,i){var a=t.extend({moduleId:String(e.id),initialize:function(e){e.CreateButtonView=e.CreateButtonView||i,t.prototype.initialize.apply(this,arguments)}});return a}.apply(t,a),!(void 0!==r&&(e.exports=r))},2736:function(e,t,i){var a,r;a=[i("require/underscore"),i(841),i("shim/splunk.util"),i(2737),i(2745)],r=function(e,t,i,a,r){var n=t.extend({initialize:function(e){e.model.savedPage=a,e.collection=r,t.prototype.initialize.call(this,e)},events:{"click .add-page":function(e){e.preventDefault()}}});return n}.apply(t,a),!(void 0!==r&&(e.exports=r))},2737:function(e,t,i){var a,r;a=[i("shim/jquery"),i("require/backbone"),i("require/underscore"),i(148),i(2738),i("splunkjs/mvc/utils"),i("shim/splunk.util"),i("collections/services/saved/Searches"),i(129),i(2743),i(2744),i(1703),i(1702),i(235)],r=function(e,t,i,a,r,n,s,o,l,d,c,p,u,h){var f=h.extend({initialize:function(){t.Model.prototype.initialize.apply(this,arguments)},idAttribute:"id",hasAcl:!1,objectNameSingular:i("ITSI Module").t(),objectNamePlural:i("ITSI Modules").t(),_objectType:a.ITSI_OBJECT_ITSI_MODULE,defaults:function(){return{id:"",title:"",description:"",entity_source_templates:[],service_templates:[],source_itsi_da:"",errors:[],_owner:"nobody"}},getEditUrl:function(){return s.make_full_url("/app/"+n.getCurrentApp()+"/itsi_module#"+this.id)},getViewUrl:function(){return this.getEditUrl()},fetch:function(t){var a=e.Deferred();if(this.isFetchable()){var r=[];r.push(this.fetchSavedSearches()),r.push(this.fetchKpiTemplates()),e.when.apply(e,r).then(i.bind(function(e,r){var n=r[0];this.parse(e[0].entry,n,t),a.resolve(this,i("Success").t(),t)},this),i.bind(function(){a.reject(null,i("Error fetching saved searches and KPI templates").t(),t)},this))}else a.reject(null,i("Model was not initialized before fetch").t(),t);return a},parse:function(a,r){var n=new t.Collection([],{model:d}),s=new t.Collection([],{model:c}),o=new u;o.getKpiTemplateName=function(e){return e.get("name")||e.get("appName")+"-"+e.get("title").replace(/ /g,"_")},i.each(r,function(e){var t=new p({title:e.title,description:e.description,name:e._key,source_itsi_da:e.source_itsi_da,_owner:"nobody",kpis:e.kpis});o.add(t),e.templateInfoModel=t}),i.each(this.get("entity_source_templates"),function(e){var t=e.name.split("://")[1],i=new d({appName:this.id,name:t,config:e,savedSearch:e.content.search_string}),a=i.validate();a?this.logError(e.name,a):n.add(i)},this),i.each(this.get("service_templates"),function(a){var n=function(t,n,s){var o=new p({title:d+" "+n+" KPI template",description:d+" "+n+" KPI template",type:n});return i.each(l.trimStrings(e.csv.toArray(t||"")),function(e){var t=s.findKpi(r,e);i.isUndefined(t)||i.isNull(t)?s.logError(a.name,i('Invalid %s KPI name "%s".').t(),n,e):(t.templateType=n,o.get("kpis").add(t))},s),o},d=a.name,u=n(a.content.recommended_kpis,"recommended",this),h=n(a.content.optional_kpis,"optional",this),f=new c({appName:this.id,name:d,config:a,recommendedkpis:new t.Collection([u],{model:p}),optionalkpis:new t.Collection([h],{model:p}),kpiTemplates:o}),m=f.validate();m?this.logError(a.name,m):s.add(f)},this),this.set("entity_source_templates",n),this.set("service_templates",s)},fetchSavedSearches:function(){return(new o).fetch({data:{search:this.id,count:0}})},fetchKpiTemplates:function(){return(new u).fetch()},filterKpiTemplateResponse:function(e){return i.filter(e,function(e){return e.source_itsi_da===this.id},this)},logError:function(e){this.get("errors").push("["+this.id+": "+e+"] "+s.sprintf.apply(this,i.rest(arguments,1)))},isFetchable:function(){return!(i.isUndefined(this.id)||i.isNull(this.id)||i.isEmpty(this.id))},findSavedSearch:function(e,t){return i.find(e,function(e){return e.acl.app===this.id&&e.name===t},this)},findKpi:function(e,t){var a=null;return i.each(e,function(e){e.source_itsi_da===this.id&&e.kpis.each(function(i){i.get("kpi_template_kpi_id")===t&&(a=i,a.parentKpiTemplate=e.templateInfoModel)},this)},this),a},findSavedSearchName:function(e){var t=null;if(!i.isUndefined(e)&&!i.isNull(e)&&e.trim().search(/^\|\s*savedsearch\s*(.+)$/)!==-1){var a=e.trim().replace(/^\|\s*savedsearch\s*(.+)$/,"$1");t=a.replace(/^"|"$/g,"")}return t}});return f}.apply(t,a),!(void 0!==r&&(e.exports=r))},2738:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var n=a(2739),s=r(n);RegExp.escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},function(e){e.csv={defaults:{separator:",",delimiter:'"',headers:!0},hooks:{castToScalar:function(e,t){var i=/\./;if(isNaN(e))return e;if(i.test(e))return parseFloat(e);var a=parseInt(e);return isNaN(a)?null:a}},parsers:{parse:function(e,t){function i(){if(d=0,c="",t.start&&t.state.rowNum<t.start)return l=[],t.state.rowNum++,void(t.state.colNum=1);if(void 0===t.onParseEntry)o.push(l);else{var e=t.onParseEntry(l,t.state);e!==!1&&o.push(e)}l=[],t.end&&t.state.rowNum>=t.end&&(p=!0),t.state.rowNum++,t.state.colNum=1}function a(){if(void 0===t.onParseValue)l.push(c);else{var e=t.onParseValue(c,t.state);e!==!1&&l.push(e)}c="",d=0,t.state.colNum++}var r=t.separator,n=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var o=[],l=[],d=0,c="",p=!1,u=(0,s.default)(r),h=(0,s.default)(n),f=/(D|S|\n|\r|[^DS\r\n]+)/,m=f.source;return m=m.replace(/S/g,u),m=m.replace(/D/g,h),f=RegExp(m,"gm"),e.replace(f,function(e){if(!p)switch(d){case 0:if(e===r){c+="",a();break}if(e===n){d=1;break}if("\n"===e){a(),i();break}if(/^\r$/.test(e))break;c+=e,d=3;break;case 1:if(e===n){d=2;break}c+=e,d=1;break;case 2:if(e===n){c+=e,d=1;break}if(e===r){a();break}if("\n"===e){a(),i();break}if(/^\r$/.test(e))break;throw new Error("CSVDataError: Illegal State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");case 3:if(e===r){a();break}if("\n"===e){a(),i();break}if(/^\r$/.test(e))break;if(e===n)throw new Error("CSVDataError: Illegal Quote [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]")}}),0!==l.length&&(a(),i()),o},splitLines:function(e,t){function i(){if(o=0,t.start&&t.state.rowNum<t.start)return l="",void t.state.rowNum++;if(void 0===t.onParseEntry)n.push(l);else{var e=t.onParseEntry(l,t.state);e!==!1&&n.push(e)}l="",t.end&&t.state.rowNum>=t.end&&(d=!0),t.state.rowNum++}var a=t.separator,r=t.delimiter;t.state.rowNum||(t.state.rowNum=1);var n=[],o=0,l="",d=!1,c=(0,s.default)(a),p=(0,s.default)(r),u=/(D|S|\n|\r|[^DS\r\n]+)/,h=u.source;return h=h.replace(/S/g,c),h=h.replace(/D/g,p),u=RegExp(h,"gm"),e.replace(u,function(e){if(!d)switch(o){case 0:if(e===a){l+=e,o=0;break}if(e===r){l+=e,o=1;break}if("\n"===e){i();break}if(/^\r$/.test(e))break;l+=e,o=3;break;case 1:if(e===r){l+=e,o=2;break}l+=e,o=1;break;case 2:var n=l.substr(l.length-1);if(e===r&&n===r){l+=e,o=1;break}if(e===a){l+=e,o=0;break}if("\n"===e){i();break}if("\r"===e)break;throw new Error("CSVDataError: Illegal state [Row:"+t.state.rowNum+"]");case 3:if(e===a){l+=e,o=0;break}if("\n"===e){i();break}if("\r"===e)break;if(e===r)throw new Error("CSVDataError: Illegal quote [Row:"+t.state.rowNum+"]");throw new Error("CSVDataError: Illegal state [Row:"+t.state.rowNum+"]");default:throw new Error("CSVDataError: Unknown state [Row:"+t.state.rowNum+"]")}}),""!==l&&i(),n},parseEntry:function(e,t){function i(){if(void 0===t.onParseValue)n.push(l);else{var e=t.onParseValue(l,t.state);e!==!1&&n.push(e)}l="",o=0,t.state.colNum++}var a=t.separator,r=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var n=[],o=0,l="";if(!t.match){var d=(0,s.default)(a),c=(0,s.default)(r),p=/(D|S|\n|\r|[^DS\r\n]+)/,u=p.source;u=u.replace(/S/g,d),u=u.replace(/D/g,c),t.match=RegExp(u,"gm")}return e.replace(t.match,function(e){switch(o){case 0:if(e===a){l+="",i();break}if(e===r){o=1;break}if("\n"===e||"\r"===e)break;l+=e,o=3;break;case 1:if(e===r){o=2;break}l+=e,o=1;break;case 2:if(e===r){l+=e,o=1;break}if(e===a){i();break}if("\n"===e||"\r"===e)break;throw new Error("CSVDataError: Illegal State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");case 3:if(e===a){i();break}if("\n"===e||"\r"===e)break;if(e===r)throw new Error("CSVDataError: Illegal Quote [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]")}}),i(),n}},toArray:function(t,i,a){var i=void 0!==i?i:{},r={};r.callback=void 0!==a&&"function"==typeof a&&a,r.separator="separator"in i?i.separator:e.csv.defaults.separator,r.delimiter="delimiter"in i?i.delimiter:e.csv.defaults.delimiter;var n=void 0!==i.state?i.state:{},i={delimiter:r.delimiter,separator:r.separator,onParseEntry:i.onParseEntry,onParseValue:i.onParseValue,state:n},s=e.csv.parsers.parseEntry(t,i);return r.callback?void r.callback("",s):s},toArrays:function(t,i,a){var i=void 0!==i?i:{},r={};r.callback=void 0!==a&&"function"==typeof a&&a,r.separator="separator"in i?i.separator:e.csv.defaults.separator,r.delimiter="delimiter"in i?i.delimiter:e.csv.defaults.delimiter;var n=[],i={delimiter:r.delimiter,separator:r.separator,onParseEntry:i.onParseEntry,onParseValue:i.onParseValue,start:i.start,end:i.end,state:{rowNum:1,colNum:1}};return n=e.csv.parsers.parse(t,i),r.callback?void r.callback("",n):n},toObjects:function(t,i,a){var i=void 0!==i?i:{},r={};r.callback=void 0!==a&&"function"==typeof a&&a,r.separator="separator"in i?i.separator:e.csv.defaults.separator,r.delimiter="delimiter"in i?i.delimiter:e.csv.defaults.delimiter,r.headers="headers"in i?i.headers:e.csv.defaults.headers,i.start="start"in i?i.start:1,r.headers&&i.start++,i.end&&r.headers&&i.end++;var n=[],s=[],i={delimiter:r.delimiter,separator:r.separator,onParseEntry:i.onParseEntry,onParseValue:i.onParseValue,start:i.start,end:i.end,state:{rowNum:1,colNum:1},match:!1},o={delimiter:r.delimiter,separator:r.separator,start:1,end:1,state:{rowNum:1,colNum:1}},l=e.csv.parsers.splitLines(t,o),d=e.csv.toArray(l[0],i),n=e.csv.parsers.splitLines(t,i);i.state.colNum=1,d?i.state.rowNum=2:i.state.rowNum=1;for(var c=0,p=n.length;c<p;c++){var u=e.csv.toArray(n[c],i),h={};for(var f in d)h[d[f]]=u[f];s.push(h),i.state.rowNum++}return r.callback?void r.callback("",s):s},fromArrays:function(t,a,r){var a=void 0!==a?a:{},n={};if(n.callback=void 0!==r&&"function"==typeof r&&r,n.separator="separator"in a?a.separator:e.csv.defaults.separator,n.delimiter="delimiter"in a?a.delimiter:e.csv.defaults.delimiter,n.escaper="escaper"in a?a.escaper:e.csv.defaults.escaper,n.experimental="experimental"in a&&a.experimental,!n.experimental)throw new Error("not implemented");var s=[];for(i in t)s.push(t[i]);return n.callback?void n.callback("",s):s},fromObjects2CSV:function(t,a,r){var a=void 0!==a?a:{},n={};if(n.callback=void 0!==r&&"function"==typeof r&&r,n.separator="separator"in a?a.separator:e.csv.defaults.separator,n.delimiter="delimiter"in a?a.delimiter:e.csv.defaults.delimiter,n.experimental="experimental"in a&&a.experimental,!n.experimental)throw new Error("not implemented");var s=[];for(i in t)s.push(arrays[i]);return n.callback?void n.callback("",s):s}},e.csvEntry2Array=e.csv.toArray,e.csv2Array=e.csv.toArrays,e.csv2Dictionary=e.csv.toObjects}(jQuery)},2739:function(e,t,i){e.exports={default:i(2740),__esModule:!0}},2740:function(e,t,i){i(2741),e.exports=i(132).RegExp.escape},2741:function(e,t,i){var a=i(160),r=i(2742)(/[\\^$*+?.()|[\]{}]/g,"\\$&");a(a.S,"RegExp",{escape:function(e){return r(e)}})},2742:function(e,t){e.exports=function(e,t){var i=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,i)}}},2743:function(e,t,i){function a(e){return e&&e.__esModule?e:{default:e}}var r,n,s=i(130),o=a(s);r=[i("shim/jquery"),i("require/backbone"),i("require/underscore"),i("shim/splunk.util"),i("util/splunkd_utils"),i(129),i(2738)],n=function(e,t,i,a,r,n,s){return t.Model.extend({objectNameSingular:i("Entity Source Template").t(),objectNamePlural:i("Entity Source Templates").t(),defaults:function(){return{id:"",title:"",saved_search:"",title_field:"",identifier_fields:[],description_fields:[],informational_fields:[],source_itsi_da:""}},initialize:function(t,a){if(this.set("id",t.name),this.set("source_itsi_da",t.appName||""),this.set("saved_search",t.savedSearch||""),t.config){var r=t.name.split(this.get("appName")+"-")[1].replace(/_/g," ");this.set("title",r||"");var s=t.config.content.entity_title_field;i.isString(s)||(s=""),this.set("title_field",s.trim()),s=t.config.content.entity_identifier_fields,i.isString(s)||(s=""),this.set("identifier_fields",n.trimStrings(e.csv.toArray(s))),s=t.config.content.entity_description_column,i.isString(s)||(s=""),this.set("description_fields",n.trimStrings(e.csv.toArray(s))),s=t.config.content.entity_informational_fields,i.isString(s)||(s=""),this.set("informational_fields",n.trimStrings(e.csv.toArray(s)))}this.on("change:title",function(e){this.set("name",this.get("appName")+"-"+this.get("title").replace(/ /g,"_"))}.bind(this))},validate:function(e,t){if(i.isEmpty(this.get("title_field")))return i("Title field cannot be empty.").t();var r=i.uniq([this.get("title_field")].concat(this.get("identifier_fields"))),n=r.concat(this.get("description_fields"),this.get("informational_fields")),s=i.filter(n,function(e,t){return n.lastIndexOf(e)===t&&n.indexOf(e)!==t});return s.length>0?a.sprintf(i("Fields cannot shared between assignments: %s.").t(),s):void 0},save:function(){var t=i.map(this.attributes,function(e,t){if(i.find(["saved_search","title_field","identifier_fields","informational_fields","description_fields"],function(e){return e===t})){var a=t;switch(t){case"saved_search":a="search_string";break;case"title_field":case"identifier_fields":case"informational_fields":a="entity_"+t;break;case"description_fields":a="entity_description_column"}switch(t){case"saved_search":e=e;break;case"identifier_fields":case"informational_fields":case"description_fields":e=i.isArray(e)?e.join(","):e}var r=e;return i.isObject(e)&&(r=(0,o.default)(e)),a+"="+encodeURIComponent(r)}return""},this),a=r.fullpath("/servicesNS/nobody/")+this.get("appName")+"/configs/conf-inputs/";if(this.isNew()){var n=this.get("appName")+"-"+this.get("title").replace(/ /g,"_");t.push("name="+encodeURIComponent("itsi_csv_import://"+n)),this.set("config",{name:n}),this.id=n}else a+=encodeURIComponent(this.get("config").name);return e.ajax({type:"POST",url:a,data:t.join("&"),dataType:"text"})}})}.apply(t,r),!(void 0!==n&&(e.exports=n))},2744:function(e,t,i){function a(e){return e&&e.__esModule?e:{default:e}}var r,n,s=i(130),o=a(s);r=[i("shim/jquery"),i("require/backbone"),i("require/underscore"),i("util/splunkd_utils"),i("shim/splunk.util"),i(129),i(2738),i(1298),i(266),i(268),i(267)],n=function(e,t,i,a,r,n,s,l,d,c,p){return t.Model.extend({objectNameSingular:i("Service Template").t(),objectNamePlural:i("Service Templates").t(),defaults:function(){return{id:"",title:"",description:"",entity_rules:new l,recommended_kpi_templates:[],optional_kpi_templates:[],source_itsi_da:""}},initialize:function(e,t){if(this.set("id",e.name),e.config){this.set("title",e.config.content.title||""),this.set("description",e.config.content.description||"");var a=function(e){var t=new l;return i.each(e,function(e){var a=new d;a.set("rule_condition",e.rule_condition||"");var r=new p;a.set("rule_items",r),i.each(e.rule_items||[],function(e){r.add(new c(e))}),t.add(a)}),t};this.set("entity_rules",a(JSON.parse(e.config.content.entity_rules||"")))}this.set("recommended_kpi_templates",e.recommendedkpis||[]),this.set("optional_kpi_templates",e.optionalkpis||[]),this.set("source_itsi_da",e.appName||"")},validate:function(e,t){},_preProcessSavePayload:function(){var e={};i.each(["optional_kpi_templates","recommended_kpi_templates"],function(a){var r=function(a){a instanceof t.Collection&&a.each(function(t){i.isObject(t)&&i.isObject(t.get("kpis"))&&t.get("kpis").each(function(t){var a=t.templateType;i.isString(a)&&(a in e||(e[a]=[]),e[a].push(t.get("kpi_template_kpi_id")))})})};r(this._modelJson[a])}.bind(this)),i.each(e,function(e,t){this._modelJson[t+"_kpis"]=e.join(",")}.bind(this))},_resolveKpiTemplatesToSave:function(){if(this._modelJson.kpiTemplates){var e={},a=this,r=function(i){var r=a._modelJson.kpiTemplates.getKpiTemplateName(i),n=!i.get("name");
return r in e||(e[r]={title:i.get("title"),description:i.get("description")||"",source_itsi_da:i.get("source_itsi_da")||i.get("appName"),_owner:i.get("_owner")||"nobody",kpis:i.get("kpis")||new t.Collection,name:r,isNew:n},i.set("name",r)),r},n=function(a){a instanceof t.Collection&&a.each(function(t){t.get("kpis").each(function(t){var a=t.parentKpiTemplate;if(i.isObject(a)){var n=r(a),s=!1;e[n].kpis.each(function(e){t.get("kpi_template_kpi_id")===e.get("kpi_template_kpi_id")&&(s=!0)}),s||e[n].kpis.add(t)}})})};return n(this._modelJson.recommendedkpis),n(this._modelJson.optionalkpis),this._modelJson.kpiTemplates.each(function(e){r(e)}),e}},_saveKpiTemplateStanzas:function(){var t=[],n=this._resolveKpiTemplatesToSave();i.each(n,function(n,s){var l=i.map(n,function(e,t){if(i.find(["title","description","kpis","source_itsi_da"],function(e){return e===t})){if("kpis"==t){var a=[];e.each(function(e){var t=e.attributes,r=["_key","kpi_base_search","search","search_aggregate","search_alert","search_entities","search_time_compare","search_time_series","search_time_series_aggregate","search_time_series_entities"];i.each(r,function(e,i){delete t[e]}),a.push(e.attributes)}),e=a}var r=e;return i.isObject(e)&&(r=(0,o.default)(e)),t+"="+encodeURIComponent(r)}return""},this);l.push("_owner=nobody");var d=a.fullpath("/servicesNS/nobody/")+n.source_itsi_da+"/configs/conf-itsi_kpi_template/";n.isNew?l.push("name="+encodeURIComponent(n.name)):d+=encodeURIComponent(n.name),t.push(e.ajax({type:"POST",url:d,data:l.join("&"),dataType:"text"}));var c=r.make_url("custom/SA-ITOA/itoa_interface/nobody/kpi_template/")+(n.isNew?"":"/"+encodeURIComponent(n.name));n._key=n.name,t.push(e.ajax({type:"POST",url:c,data:{data:(0,o.default)(n)},contentType:"application/x-www-form-urlencoded",dataType:"json"}))}.bind(this));var s=e.Deferred();return e.when.apply(e,t).then(i.bind(function(){s.resolve(this,i("KPI Templates saved.").t())},this),i.bind(function(){console.error("Error saving some or all KPI templates."),s.reject(null,i("Error saving some or all KPI templates.").t())},this)),s},_saveServiceTemplateStanza:function(){var t=i.map(this._modelJson,function(e,t){if(i.find(["title","description","entity_rules","recommended_kpis","optional_kpis"],function(e){return e===t})){var a=e;return i.isObject(e)&&(a=(0,o.default)(e)),t+"="+encodeURIComponent(a)}return""},this),r=a.fullpath("/servicesNS/nobody/")+this.get("appName")+"/configs/conf-itsi_service_template/";return this.isNew()?t.push("name="+encodeURIComponent(this.getStanzaName())):r+=encodeURIComponent(this.getStanzaName()),e.ajax({type:"POST",url:r,data:t.join("&"),dataType:"text"})},save:function(){this._modelJson=this.toJSON(),this._preProcessSavePayload();var t=e.Deferred(),a=[];return a.push(this._saveServiceTemplateStanza()),a.push(this._saveKpiTemplateStanzas()),e.when.apply(e,a).then(i.bind(function(){t.resolve(this,i("Service Template saved.").t())},this),i.bind(function(){console.error("Error saving some or all Service Template configuration."),t.reject(null,i("Error saving some or all Service Template configuration.").t())},this)),t},getStanzaName:function(){return this.isNew()?this.get("appName")+"-"+this.get("title").replace(/ /g,"_"):this.get("config").name},delete:function(){var t=a.fullpath("/servicesNS/nobody/")+this.get("appName")+"/configs/conf-itsi_service_template/";return t+=encodeURIComponent(this.getStanzaName()),e.ajax({type:"DELETE",url:t,async:!0})}})}.apply(t,r),!(void 0!==n&&(e.exports=n))},2745:function(e,t,i){var a,r;a=[i("shim/jquery"),i("require/backbone"),i("require/underscore"),i("shim/splunk.util"),i("collections/services/AppLocals"),i(2746),i(2709),i(2737),i(256)],r=function(e,t,i,a,r,n,s,o,l){var d=l.extend({model:o,initialize:function(e,i){t.Collection.prototype.initialize.apply(this,arguments)},fetch:function(t){var a=[];a.push(this.fetchItsiServiceTemplateConfigs()),a.push(this.fetchItsiInputsConfigs()),a.push(this.fetchAppLocalsConfigs());var r=e.Deferred();return e.when.apply(e,a).then(i.bind(function(a,n,s){this.parse(a[0].entry,i.filter(n[0].entry,function(e){var t=e.name.split("://")[0],i=e.acl.app;return"itsi_csv_import"===t&&0===i.indexOf("DA-ITSI-")}),s[0].entry,t);var o=i.map(this.models,function(e){return e.fetch()});e.when.apply(e,o).then(i.bind(function(){this.trigger("reset",this,{}),r.resolve(this,i("Success").t())},this),i.bind(function(){r.reject(null,i("Error fetching data for ITSI Module model").t(),t)},this))},this),i.bind(function(){r.reject(null,i("Error fetching ITSI Module configs.").t(),t)},this)),r},parse:function(e,t,a,r){i.each(e,function(e){var t=e.acl.app,r=this.get(t);if(i.isNull(r)||i.isUndefined(r)){r=new o;var n=this.findAppInfo(a,t);r.set("id",t),r.set("title",n.content.label),r.set("description",n.content.description),r.set("source_itsi_da",t),this.add(r)}r.get("service_templates").push(e)},this),i.each(t,function(e){var t=e.acl.app,r=this.get(t);if(i.isNull(r)||i.isUndefined(r)){r=new o;var n=this.findAppInfo(a,t);r.set("id",t),r.set("title",n.content.label),r.set("description",n.content.description),r.set("source_itsi_da",t),this.add(r)}r.get("entity_source_templates").push(e)},this)},fetchItsiServiceTemplateConfigs:function(){return(new n).fetch({data:{count:0}})},fetchItsiInputsConfigs:function(){return(new s).fetch({data:{count:0}})},fetchAppLocalsConfigs:function(){return(new r).fetch({data:{count:0}})},findAppInfo:function(e,t){return i.find(e,function(e){return e.name===t})},setUrl:function(e){"nobody"!==e&&console.error("ITSI Modules must have owner 'nobody'")}});return d}.apply(t,a),!(void 0!==r&&(e.exports=r))},2746:function(e,t,i){var a,r;a=[i("shim/jquery"),i("require/backbone"),i("require/underscore"),i("collections/SplunkDsBase"),i(2747)],r=function(e,t,i,a,r){return a.extend({url:"configs/conf-itsi_service_template",model:r,initialize:function(){a.prototype.initialize.apply(this,arguments)}})}.apply(t,a),!(void 0!==r&&(e.exports=r))},2747:function(e,t,i){var a,r;a=[i("shim/jquery"),i("require/backbone"),i("require/underscore"),i("models/SplunkDBase")],r=function(e,t,i,a){return a.extend({url:"configs/conf-itsi_service_template",initialize:function(){a.prototype.initialize.apply(this,arguments)}})}.apply(t,a),!(void 0!==r&&(e.exports=r))}});