webpackJsonp([16],[function(e,t,i){var a,n;i.p=function(){function e(){for(var e,i,a="",n=0,s=arguments.length;n<s;n++)e=arguments[n].toString(),i=e.length,i>1&&"/"==e.charAt(i-1)&&(e=e.substring(0,i-1)),a+="/"!=e.charAt(0)?"/"+e:e;if("/"!=a){var l=a.split("/"),r=l[1];if("static"==r||"modules"==r){var o=a.substring(r.length+2,a.length);a="/"+r,window.$C.BUILD_NUMBER&&(a+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(a+="."+window.$C.BUILD_PUSH_NUMBER),"app"==l[2]&&(a+=":"+t("APP_BUILD",0)),a+="/"+o}}var d=t("MRSPARKLE_ROOT_PATH","/"),c=t("DJANGO_ROOT_PATH",""),u=t("LOCALE","en-US"),v="";return v=c&&a.substring(0,c.length)===c?a.replace(c,c+"/"+u.toLowerCase()):"/"+u+a,""==d||"/"==d?v:d+v}function t(e,t){if(window.$C&&window.$C.hasOwnProperty(e))return window.$C[e];if(void 0!==t)return t;throw new Error("getConfigValue - "+e+" not set, no default provided")}return e("/static/app/itsi/build/pages")+"/"}(),a=[i(1750),i("shim/jquery"),i("require/underscore"),i(1335),i(1646),i(1700),i(473),i(1647),i(1650),i(2102),i(1681),i(2077),i(2099),i(4),i(129),i(229),i("util/time"),i(1407),i(2100)],n=function(e,t,i,a,n,s,l,r,o,d,c,u,v,f,p,m,g,_){var h=f(i("Glass Table").t());t("#app-main-layout").html('<div class="gt-body main-section-body" data-role="main"><div class="dashboard-header glass-table-header application-page-header"></div><div class="glass-table-editor-container"></div></div>');var b=t.Deferred(),y=function(e){var t=e.get("parent"),i=new o;return i.fetchForService(t).then(function(){if(e.get("isSwappable"))return e;e.unset("assetId",{silent:!0}),e.set({parent:""},{silent:!0});var t=e.get("statModel");t.unset("assetId",{silent:!0}),t.set({useGenerated:!1,severityField:"alert_color",thresholdLabel:"alert_value",thresholdMode:!1},{silent:!0});var i=t.get("thresholdSettingModel");i.set({metricField:"alert_value"},{silent:!0})},function(){}),e},w=function(e){var t=e.get("statModel");if(!t.get("useGenerated")){t.get("thresholdSettingModel").set({metricField:"alert_value"},{silent:!0});var i=this.assetCollection.get(e.get("assetId")),a=i.get("kpiRawEarliest");t.set({earliest:a,sparklineEarliest:g.convertAmountAndUnitToSeconds(a.slice(0,a.length-1),a.charAt(a.length-1))},{silent:!0})}return e},T=function(e){var t=new l({errorMessage:r.errors.glassTableFetch,htmlResponse:e});t.show()},A={};A[r.vizType.toolbarWidget]=_.BaseParser.bind(null,{minDataCount:1,maxDataCount:1});var C={},S=i.template("index=<%= summaryIndex %> (<%= assetIdList %>) `service_level_kpi_only` | stats latest(<%= metricValue %>) AS <%= metricValue %>, latest(<%= severityColor %>) AS <%= severityColor %>, latest(<%= severityLabel %>) AS <%= severityLabel %>, latest(_time) AS _time BY <%= assetIdField %>");C[r.vizType.singleValue]=S,C[r.vizType.gauge]=S,C[r.vizType.singleValueDelta]=i.template('index=<%= summaryIndex %> (<%= assetIdList %>) `service_level_kpi_only` | addinfo | eval event_age=info_max_time - _time | where event_age < 3 * 60 * 60 | sort 0 -_time | stats list(<%= metricValue %>) AS <%= metricValue %>, list(_time) AS _time, latest(<%= severityColor %>) AS <%= severityColor %>, latest(<%= severityLabel %>) AS <%= severityLabel %> BY <%= assetIdField %> | eval <%= metricValue %>=mvindex(<%= metricValue %>, 0, 1) | eval _time=strftime(mvindex(_time, 0, 1), "%Y-%m-%dT%T.%Q%:z")'),C[r.vizType.sparkline]=i.template("index=<%= summaryIndex %> (<%= assetIdList %>) `service_level_kpi_only` | bin _time as bin_time | stats latest(<%= metricValue %>) AS <%= metricValue %>, latest(<%= severityColor %>) AS <%= severityColor %>, latest(<%= severityLabel %>) AS <%= severityLabel %> BY <%= assetIdField %>, bin_time | rename bin_time as _time"),C[r.vizType.toolbarWidget]=S;var I=new _.SearchDispatcher({mapping:{summaryIndex:"itsi_summary",assetIdField:"indexed_itsi_kpi_id",metricValue:"alert_value",severityColor:"alert_color",severityLabel:"alert_severity"},parserExtensions:A,searchTemplateMap:C}),M={filesEndpoint:"SA-ITOA/v1/files",iconCollectionEndpoint:"SA-ITOA/v1/icon_collection",AssetCollection:d,Constants:r,ContextPanelView:s,ToolRegistry:n,$el:t(".main-section-body").first(),urlTokenModel:h.urlTokenModel,defaultTokenModel:h.defaultTokenModel,setupView:!1,listerView:"glass_tables_lister",editorView:"glass_table_editor",GlassTableHeaderView:u,ConfigPanelView:v,assetToAdhoc:y,assetRefresh:w,searchDispatcher:I,deleteWarning:i("Widget converted to ad hoc search because KPI was not found.").t(),widgetLabelMaxTextLines:-1,assetItem:{label:i("KPI").t(),value:"kpi"},assetParentLabel:i("Service").t()},L=function(){var e=new c({_key:h.defaultTokenModel.get("savedGlassTableId"),_owner:h.defaultTokenModel.get("owner")});e.fetch().done(function(){var a=t.Deferred();if(a.done(function(t){x(i.extend({},M,{editCapable:t,model:e}))}),"app"===e.get("acl").sharing){var n=p.isUserCapable("glass_table","write");n.done(function(e){var t=!1;"undefined"!=typeof e.is_capable&&null!==e.is_capable&&(t=e.is_capable),a.resolve(t)}),n.fail(function(e){T(e)})}else a.resolve(!0)}).fail(function(e){T(e)})},k=function(){var e=new m,a=t.Deferred();return e.fetch({data:{count:0}}).done(function(){var t="datamodels://",n=[];e.each(function(e){if(!p.isEmpty(e.entry)&&!p.isEmpty(e.entry.content)){var a=e.entry,s=a.get("name","");if(!p.isEmptyString(s)&&0===s.indexOf(t)){var l=a.content,r=l.get("blacklist");i.isString(r)&&(r=r.replace(/(\n*)/g,"").split("|")),i.each(r,function(e){n.push(e.trim())})}}}),a.resolve(n)}).fail(function(e){T(e),a.reject()}),a},x=function(e){var t=new a(e);t.render(),k().done(function(e){t.setDataModelBlacklist(e)}),b.resolve(t)},V=h.defaultTokenModel.get("savedGlassTableId");if(V)L();else if(i.isEmpty(h.defaultTokenModel.attributes)&&window.location.href.indexOf("=")>-1&&window.location.href.indexOf("tour=")<0)h.defaultTokenModel.once("change reset",function(){L()});else{var E=p.isUserCapable("glass_table","write");E.done(function(e){"undefined"!=typeof e.is_capable?(M.defaultTokenModel.unset("id"),x(i.extend({},M,{GlassTableModel:c}))):T(e)}),E.fail(function(e){T(e)})}return b}.apply(t,a),!(void 0!==n&&(e.exports=n))}]);