webpackJsonp([26],{0:function(e,t,n){var i,a;n.p=function(){function e(){for(var e,n,i="",a=0,s=arguments.length;a<s;a++)e=arguments[a].toString(),n=e.length,n>1&&"/"==e.charAt(n-1)&&(e=e.substring(0,n-1)),i+="/"!=e.charAt(0)?"/"+e:e;if("/"!=i){var d=i.split("/"),o=d[1];if("static"==o||"modules"==o){var r=i.substring(o.length+2,i.length);i="/"+o,window.$C.BUILD_NUMBER&&(i+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(i+="."+window.$C.BUILD_PUSH_NUMBER),"app"==d[2]&&(i+=":"+t("APP_BUILD",0)),i+="/"+r}}var c=t("MRSPARKLE_ROOT_PATH","/"),l=t("DJANGO_ROOT_PATH",""),h=t("LOCALE","en-US"),u="";return u=l&&i.substring(0,l.length)===l?i.replace(l,l+"/"+h.toLowerCase()):"/"+h+i,""==c||"/"==c?u:c+u}function t(e,t){if(window.$C&&window.$C.hasOwnProperty(e))return window.$C[e];if(void 0!==t)return t;throw new Error("getConfigValue - "+e+" not set, no default provided")}return e("/static/app/itsi/build/pages")+"/"}(),i=[n("shim/jquery"),n("require/backbone"),n("require/underscore"),n("shim/jquery.ui.resizable"),n("shim/splunk.util"),n("splunkjs/mvc/searchmanager"),n("splunkjs/mvc/postprocessmanager"),n(129),n(473),n(4),n(231),n(862),n(2761),n(2764),n(2772),n(2773)],a=function(e,t,n,i,a,s,d,o,r,c,l,h,u,m,w){var p=c(n("Maintenance Window Detail View").t()),v=n("You do not have write permissions for some of the entities or services associated with this maintenance window. You cannot edit or save any changes.").t(),f=e("#app-main-layout"),b=n.template(w,null,{variable:"vars"});f.html(b({_:n}));var g=function(){e(".maintenance-window-message-container",f).show(),e(".maintenance-window-message-container .alert-message",f).html(v)},M=function(){var t=p.defaultTokenModel.get("savedMaintenanceWindowId"),i=(a.getConfigValue("USERNAME","nobody"),function(e,t){var i=new r({errorMessage:n("Could not load settings for the page.").t(),htmlResponse:t});i.show()}),d=new l;this.serviceTitleKeys=d.getTitlesAndKeys(),this.serviceMap={};var o=new h({_key:t}),c=o.fetch();e.when(c,this.serviceTitleKeys).done(function(i,a){n.each(a[0],function(e){this.serviceMap[e._key]=e.title}.bind(this));var d=new u({maintenanceWindowSavedModel:o}),r=e(".maintenance-window-configuration-container",f);r.append(d.render().el);var c,l,h,w,p,v="",b="",M=o.getAffectedServicesAndEntities();if("entity"===o.getMaintenanceObjectType()){var _=M.entities;p="Entity",n.each(_,function(e){v+="("+e+' AND entity_key="'+e+'") OR'}.bind(this))}else if("service"===o.getMaintenanceObjectType()){var y=M.services;p="Service",b=" | eval objects._key=mvfilter(",n.each(y,function(e){v+="("+e+' AND itsi_service_id="'+e+'") OR',b+="'objects._key'=\""+e+'" OR'}.bind(this)),b=b.slice(0,-3)+")"}v=v.slice(0,-3);var S="index=itsi_summary alert_level=-2 "+v;c=" | inputlookup itsi_maintenance_calendar where _key="+t+b+"| mvexpand objects._key | rename objects._key AS "+p+"| table "+p,l="stats max(indexed_is_service_max_severity_event), values(entity_title) as Entities, first(kpi) as KPI by itsi_service_id, kpiid | rename max(indexed_is_service_max_severity_event) as Impacted | rename itsi_service_id as Service |  table KPI, Service, Impacted, Entities",h=new s({id:"mw-affected-objects-e",earliest_time:o.get("start_time"),latest_time:o.get("end_time"),preview:!1,cache:600,status_buckets:0,search:c,time_format:"%s.%Q",auto_cancel:65,sample_ratio:null},{tokens:!1}),w=new s({id:"mw-affected-objects-s",earliest_time:o.get("start_time"),latest_time:o.get("end_time"),preview:!1,cache:600,status_buckets:0,search:S+"| "+l,time_format:"%s.%Q",auto_cancel:65,sample_ratio:null},{tokens:!1});var W=new m({configuredObjectsSearchManager:h,impactedObjectsSearchManager:w,el:e(".maintenance-window-detail-tabviews-container"),maintenanceWindowSavedModel:o}),T=W.render().$el;o.get("can_edit")||g(),f.append(T)}.bind(this)).fail(function(e,t){i(e,t)}.bind(this))};o.setupViewFromDefaultTokenModel(p,M,"savedMaintenanceWindowId")}.apply(t,i),!(void 0!==a&&(e.exports=a))},2761:function(e,t,n){var i,a;i=[n("require/underscore"),n("shim/jquery"),n("splunkjs/mvc/utils"),n("shim/splunk.util"),n("util/splunkd_utils"),n("views/Base"),n("views/shared/dialogs/TextDialog"),n(473),n(149),n(863),n(252),n(2762)],a=function(e,t,n,i,a,s,d,o,r,c,l,h){var u=s.extend({className:"list-dotted",tagName:"dl",initialize:function(e){if(s.prototype.initialize.apply(this,arguments),!e||!e.maintenanceWindowSavedModel)throw"MaintenanceWindowDetailConfigurationView: maintenanceWindowSavedModel should be passed as an argument";this.maintenanceWindowSavedModel=e.maintenanceWindowSavedModel},render:function(){this._getUserTimeSettings()},renderThisView:function(){var t=this.maintenanceWindowSavedModel.getMaintenanceWindowStatus(),n=i.make_full_url("/app/itsi/maintenance_windows_lister"),a=this.maintenanceWindowSavedModel.getMaintenanceWindowStartTime(),s=i.sprintf(e("(%s UTC)").t(),a.toLocaleString()),d=this.maintenanceWindowSavedModel.getMaintenanceWindowEndTime(),o=i.sprintf(e("(%s UTC)").t(),d.toLocaleString()),c=r.convertUtcDateToTimezoneDate(a,1e3*this.userTimezoneObject.get("offset"));c=r.getLocalizedDate(c);var l="";return this.maintenanceWindowSavedModel.isIndefinite()?l=d:(l=r.convertUtcDateToTimezoneDate(d,1e3*this.userTimezoneObject.get("offset")),l=r.getLocalizedDate(l)),this.$el.html(this.compiledTemplate({_:e,linkText:e("< Back to Maintenance Windows").t(),title:this.maintenanceWindowSavedModel.getMaintenanceWindowTitle(),state:t,start_time:c,end_time:l.toLocaleString()||e("No End Time").t()})),this.$(".lister-page-link-text").prop("href",n),this.$(".start-time-tz").append(' <span class="start-time-utc">'+s+"</span>"),this.maintenanceWindowSavedModel.isIndefinite()||this.$(".end-time-tz").append(' <span class="end-time-utc">'+o+"</span>"),t===e("Active").t()&&this.maintenanceWindowSavedModel.get("can_edit")||(this.$(".btn-end-now").addClass("disabled"),this.$(".btn-end-now").prop("disabled",!0)),t!==e("Completed").t()&&this.maintenanceWindowSavedModel.get("can_edit")||(this.$(".btn-edit").addClass("disabled"),this.$(".btn-edit").prop("disabled",!0)),this},events:{"click .btn-edit":function(e){e.preventDefault(),this._maintenanceWindowEditWorkflowView=new c({model:{savedPage:this.maintenanceWindowSavedModel},redirectOnCreate:!0,mode:"edit"}),this._maintenanceWindowEditWorkflowView.show(),this._maintenanceWindowEditWorkflowView.render()},"click .btn-end-now":function(a){a.preventDefault();var s=new d({id:"modal_endNow"});s.dialogShown=function(){this.trigger("show"),e.debounce(function(){this.$(".btn-primary:first").focus()}.bind(this),0)()},s.settings.set("primaryButtonLabel",e("End Now").t()),s.settings.set("cancelButtonLabel",e("Cancel").t()),s.settings.set("titleLabel",e("End Maintenance Window Now").t()),s.setText(i.sprintf(e("Are you sure you want to end %s now?").t(),"<em>"+e.escape(this.maintenanceWindowSavedModel.get("title"))+"</em>")),s.on("click:primaryButton",function(){this.maintenanceWindowSavedModel.set({end_time:Date.now()/1e3}),this.maintenanceWindowSavedModel.save().done(function(){s.hide();var e=i.make_full_url("/app/itsi/maintenance_window_detail_view?savedMaintenanceWindowId="+this.maintenanceWindowSavedModel.getMaintenanceWindowId());n.redirect(e,!1)}.bind(this)).error(function(t){var n=new o({errorMessage:e("Could not load/save the maintenance window.").t(),htmlResponse:t});n.show()}.bind(this))},this),s.on("hidden",function(){s.remove()},this),t("body").append(s.render().el),s.show()}},_getUserTimeSettings:function(){var e=l.userTimezone.fetchUserAuthTimezone();e.done(function(e){this.userTimezoneObject=e,this.renderThisView()}.bind(this)).fail(function(){console.log("Could not retrieve user time settings. Something is wrong!")}.bind(this))},template:'\t\t\t\t\t<div class="title-container">\t\t\t\t\t<div><h2 class="maintenance-window-title"><%- title %></h2>\t\t\t\t\t<a class="lister-page-link-text"><%- linkText %></a></div>\t\t\t\t\t<div class="button-container"><a class="btn btn-edit"><%- _("Edit").t() %></a>\t\t\t\t\t<a class="btn btn-primary btn-end-now"><%- _("End Now").t() %></a></div>\t\t\t\t\t</div>\t\t\t\t\t<dt class="state"><%- _("State").t() %></dt>\t\t\t\t\t<dd>\t\t\t\t\t<%- state %>\t\t\t\t\t</dd>\t\t\t\t\t<dt class="startTime"><%- _("Start Time").t() %></dt>\t\t\t\t\t<dd class="start-time-tz">\t\t\t\t\t\t<%- start_time %>\t\t\t\t\t</dd>\t\t\t\t\t<dt class="endTime"><%- _("End Time").t() %></dt>\t\t\t\t\t<dd class="end-time-tz">\t\t\t\t\t\t<%- end_time %>\t\t\t\t\t</dd>\t\t\t\t'});return u}.apply(t,i),!(void 0!==a&&(e.exports=a))},2762:function(e,t,n){var i=n(2763);"string"==typeof i&&(i=[[e.id,i,""]]);n(15)(i,{});i.locals&&(e.exports=i.locals)},2763:function(e,t,n){t=e.exports=n(14)(),t.push([e.id,'dl{margin-left:20px}.list-dotted dt:after{content:""}.startTime .endTime .objects,dd{margin:10px 0}.maintenance-window-title{font-size:20px;font-weight:200}.title-container{margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.button-container{padding-right:10px}.maintenance-window-detail-table td.numeric,.maintenance-window-detail-table th.numeric{text-align:left}',""])},2764:function(e,t,n){var i,a;i=[n("require/underscore"),n("shim/jquery"),n("require/backbone"),n(129),n(2358),n(2765),n(2770)],a=function(e,t,n,i,a,s,d){var o=n.View.extend({initialize:function(e){if(n.View.prototype.initialize.apply(this,arguments),!e.configuredObjectsSearchManager)throw"MaintenanceWindowAffectedObjectsView: Must provide configuredObjectsSearchManager option";if(!e.impactedObjectsSearchManager)throw"MaintenanceWindowAffectedObjectsView: Must provide impactedObjectsSearchManager option";if(!e.maintenanceWindowSavedModel)throw"MaintenanceWindowAffectedObjectsView: Must provide maintenanceWindowSavedModel option";this.configuredObjectsSearchManager=e.configuredObjectsSearchManager,this.impactedObjectsSearchManager=e.impactedObjectsSearchManager,this.maintenanceWindowSavedModel=e.maintenanceWindowSavedModel,this.childViews={},this.configuredObjectsTab=new s({searchManager:this.configuredObjectsSearchManager,maintenanceWindowSavedModel:this.maintenanceWindowSavedModel}),this.impactedObjectsTab=new d({searchManager:this.impactedObjectsSearchManager,maintenanceWindowSavedModel:this.maintenanceWindowSavedModel}),this.childViews.affectedObjectsTabs=new a({tabs:[this.configuredObjectsTab,this.impactedObjectsTab]})},render:function(){var e=this.$(".maintenance-window-detail-table-container");return e.append(this.childViews.affectedObjectsTabs.render().$el),this.$(".tab-label:first",e).tab("show"),this},remove:function(){return e.each(this.childViews,function(e){e.remove()}),n.View.prototype.remove.apply(this,arguments)}});return o}.apply(t,i),!(void 0!==a&&(e.exports=a))},2765:function(e,t,n){var i,a;i=[n("require/underscore"),n("shim/jquery"),n("require/backbone"),n(2365),n(2766)],a=function(e,t,n,i,a){var s=i.extend({initialize:function(t){if(t=t||{},!t.searchManager)throw"MaintenanceWindowConfiguredObjectsTabView: Must provide searchManager";if(this.searchManager=t.searchManager,!t.maintenanceWindowSavedModel)throw"MaintenanceWindowConfiguredObjectsTabView: Must provide maintenanceWindowSavedModel";this.maintenanceWindowSavedModel=t.maintenanceWindowSavedModel,t.tabId="configured",t.tabLabel=e("Configured Objects").t(),"entity"===this.maintenanceWindowSavedModel.getMaintenanceObjectType()?t.tabLabel=e("Configured Entities").t():"service"===this.maintenanceWindowSavedModel.getMaintenanceObjectType()&&(t.tabLabel=e("Configured Services").t()),t.ContentView=a,t.contentViewOptions={searchManager:this.searchManager,maintenanceWindowSavedModel:this.maintenanceWindowSavedModel},i.prototype.initialize.apply(this,arguments)}});return s}.apply(t,i),!(void 0!==a&&(e.exports=a))},2766:function(e,t,n){var i,a;i=[n("shim/jquery"),n("require/underscore"),n("require/backbone"),n("splunkjs/mvc/utils"),n("shim/splunk.util"),n("splunkjs/mvc/tokenutils"),n("splunkjs/mvc/tableview"),n(231),n(887),n(2767),n(1220),n(2768),n(2769),n(1218)],a=function(e,t,n,i,a,s,d,o,r,c,l,h,u,m){var w=n.View.extend({tagName:"div",className:"maintenance-window-detail-table",initialize:function(e){this.searchManager=e.searchManager,this._maintenanceWindowSavedModel=e&&e.maintenanceWindowSavedModel;var t=new o;this.serviceTitleKeys=t.getTitlesAndKeys();var n=new r;this.entityTitleKeys=n.getTitlesAndKeys(),this.serviceMap={},this.entityMap={},this.detailTable=new d({id:"maintenance-window-detail-table"+this.cid,managerid:this.searchManager.id,drilldown:"none",drilldownRedirect:!1,pageSize:20,pagerPosition:"top",showPager:!0,el:this.$el}),this.maintenanceWindowResultsModel=this.searchManager.data("preview",{output_mode:"json_rows",output_time_format:"%s.%Q"})},events:{},render:function(){return this.maintenanceWindowResultsModel.on("data",this._renderDetailsTable,this),this},_renderDetailsTable:function(){this.entityTitleKeys.done(function(e){t.each(e,function(e){this.entityMap[e._key]=e.title}.bind(this)),this.detailTable.table.addCellRenderer(new u({entityMap:this.entityMap})),this.serviceTitleKeys.done(function(e){t.each(e,function(e){this.serviceMap[e._key]=e.title}.bind(this)),this.detailTable.table.addCellRenderer(new l),this.detailTable.table.addCellRenderer(new c({serviceMap:this.serviceMap})),this.detailTable.table.addCellRenderer(new h),this.detailTable.render()}.bind(this)).fail(function(){console.log("serviceCollection fetch failed")})}.bind(this)).fail(function(){console.log("entityCollection fetch failed")})}});return w}.apply(t,i),!(void 0!==a&&(e.exports=a))},2767:function(e,t,n){var i,a;i=[n("require/underscore"),n("shim/jquery"),n("require/backbone"),n("splunkjs/mvc/tableview"),n(1218)],a=function(e,t,n,i,a){var s=i.BaseCellRenderer.extend({initialize:function(t){this.attr="Service",this.localizedAttr=e("Service").t(),t&&t.serviceMap&&(this.serviceMap=t.serviceMap)},canRender:function(e){return e.field===this.attr},render:function(t,n){var i=n.value,a=this.serviceMap[i],s="";a||(a=e("Service deleted or permissions denied").t(),s="service-title-italic"),t.html('<div class="service-title"></div>');var d=t.find(".service-title");s&&d.addClass(s),d.text(a)}});return s}.apply(t,i),!(void 0!==a&&(e.exports=a))},2768:function(e,t,n){var i,a;i=[n("require/underscore"),n("shim/jquery"),n("require/backbone"),n("splunkjs/mvc/tableview"),n(1218)],a=function(e,t,n,i,a){var s=i.BaseCellRenderer.extend({initialize:function(t){this.attr="Impacted",this.localizedAttr=e("Impacted").t()},canRender:function(e){return e.field===this.attr},render:function(t,n){var i=parseInt(n.value,10),a=0===i?e("Partially").t():e("Fully").t();t.html('<div class="impact"></div>');var s=t.find(".impact");s.text(a)}});return s}.apply(t,i),!(void 0!==a&&(e.exports=a))},2769:function(e,t,n){var i,a;i=[n("require/underscore"),n(1221)],a=function(e,t){var n=t.extend({initialize:function(t){this.attr="Entity",this.localizedAttr=e("Entity").t(),t&&t.entityMap&&(this.entitiyMap=t.entityMap)},canRender:function(e){return e.field===this.attr},render:function(t,n){var i=n.value,a=this.entitiyMap[i],s="";a||(a=e("Entity deleted or permissions denied").t(),s="entity-title-italic"),t.html('<div class="entity-title"></div>');var d=t.find(".entity-title");s&&d.addClass(s),d.text(a)}});return n}.apply(t,i),!(void 0!==a&&(e.exports=a))},2770:function(e,t,n){var i,a;i=[n("require/underscore"),n("shim/jquery"),n("require/backbone"),n(2365),n(2764),n(2766),n(2771)],a=function(e,t,n,i,a,s,d){var o=i.extend({initialize:function(t){if(t=t||{},!t.searchManager)throw"MaintenanceWindowImpactedObjectsTabView: Must provide searchManager";if(this.searchManager=t.searchManager,!t.maintenanceWindowSavedModel)throw"MaintenanceWindowImpactedObjectsTabView: Must provide maintenanceWindowSavedModel";this.maintenanceWindowSavedModel=t.maintenanceWindowSavedModel,t.tabId="impacted",t.tabLabel=e("Impacted KPIs").t(),1e3*this.maintenanceWindowSavedModel.get("start_time")>Date.now()?t.ContentView=d:(t.ContentView=s,t.contentViewOptions={searchManager:this.searchManager,maintenanceWindowSavedModel:this.maintenanceWindowSavedModel}),i.prototype.initialize.apply(this,arguments)}});return o}.apply(t,i),!(void 0!==a&&(e.exports=a))},2771:function(e,t,n){var i,a;i=[n("require/underscore"),n("views/Base")],a=function(e,t){var n=t.extend({tagName:"dl",render:function(){return this.$el.html(this.compiledTemplate({_:e,containerText:e("Once the maintenance window is active, the impacted KPIs will be populated here.").t()})),this},template:"\t \t\t\t\t<div><%- containerText %></div></div>\t\t\t\t"});return n}.apply(t,i),!(void 0!==a&&(e.exports=a))},2772:function(e,t){e.exports='<div class="maintenance-window-detail-container">\n    <div class="maintenance-window-message-container hide">\n        <div class="alert alert-warning">\n            <i class="icon-alert"></i>\n            <span class="alert-message"></span>\n        </div>\n    </div>\n    <div class="maintenance-window-configuration-container"></div>\n    <div class="maintenance-window-detail-tabviews-container">\n        <div class="maintenance-window-detail-table-container"></div>\n    </div>\n</div>'},2773:function(e,t,n){var i=n(2774);"string"==typeof i&&(i=[[e.id,i,""]]);n(15)(i,{});i.locals&&(e.exports=i.locals)},2774:function(e,t,n){t=e.exports=n(14)(),t.push([e.id,".maintenance-window-message-container{position:absolute;z-index:120;background-color:#fcf3d7;border:1px solid #f2c33c;top:90px;left:15%;right:15%;border-radius:4px;padding-left:15px;padding-top:10px}.maintenance-window-message-container .alert-warning{padding-bottom:15px;margin-bottom:0}.maintenance-window-message-container .alert-message{padding-left:10px}",""])}});